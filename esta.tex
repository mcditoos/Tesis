 \documentclass{book}

% Set up data if you need to add a package, go here
\input{setup/packages.tex}

\titleclass{\part}{top}
\titleformat{\part}[display]
  {\normalfont\huge\bfseries}{\centering\partname\ \thepart}{20pt}{\Huge\centering}
\titlespacing*{\part}{0pt}{50pt}{40pt}
\titleclass{\chapter}{straight}
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titlespacing*{\chapter} {0pt}{50pt}{40pt}

\begin{document}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \newpage}
\raggedbottom


\thispagestyle{empty}
\setlength\headheight{0pt} 
\begin{center}

\begin{center}
\includegraphics[width=1\linewidth]{images/logo.jpg}            
\end{center}    

  \vspace{3 cm}

        {\Large\bfseries  ``Interaction-free measurements of different absorbers''\par}

        \vspace{0.5cm}
        {\Large\itshape by \\ \bfseries Gerardo José Suárez Rodríguez \par \par}
        

\vspace{2cm}

Submitted in Partial Fulfillment of the Requirements for the Degree \\
Master of Science, \\ Physics\\
Supervised by\par
Dr. Alonso Contreras Astorga  \\
Dra. Sara Guadalupe Cruz y Cruz\\


\vspace{1cm}
\large
\today

\end{center}

\clearpage

\tableofcontents
\addtocontents{toc}{\protect\thispagestyle{empty}}
\pagebreak
\pagenumbering{Roman}
\chapter*{Declaration}
I hereby certify that the material, which I now submit for assessment on the programs of study leading to the award of Master of Science, is entirely my work and has not been taken from the work of others except to the extent that such work has been cited and acknowledged within the text of my work. No portion of the work contained in this thesis has been submitted in support of an application for another degree or qualification to this or any other institution.
\addcontentsline{toc}{section}{Declaration}

\vspace{2cm}
\begin{flushright}
-----------------------------------\\
Gerardo Suárez\\
\today
\end{flushright}
\pagebreak

%List of figures and tables, automatic from thesis.
\addcontentsline{toc}{section}{List of Figures}
\listoffigures\newpage
\addcontentsline{toc}{section}{List of Tables}
\listoftables\newpage
\blankpage{}
\chapter*{Acknowledgements}
Most figures were made using svgs from flaticom.com, the component library of Alexander Franzen and the noun project
\addcontentsline{toc}{section}{Acknowledgements}

\pagebreak



\blankpage{}

\chapter*{Abstract}
This is done at the end of the project
\addcontentsline{toc}{section}{Abstract}


\pagebreak


\blankpage{}

\chapter*{Introduction}


\blankpage{}

\pagenumbering{arabic}

\chapter{Spontaneous parametric down conversion}

In this section, we will explore the quantum theory of Spontaneous Parametric Down-Conversion (SPDC), following the approach taken in \cite{procopio,multiphoton}. The SPDC phenomenon is a process in which an intense laser beam called pump beam, is incident into a nonlinear crystal. Occasionally, one photon of the pump beam is annihilated in the crystal and two photons known as signal and idler photons, of lower frequencies, are created preserving the total energy and linear momentum.

Considering that the energy is given by $E=\hbar w$, where $w$ is the angular frequency, and the linear momentum is ($\mathbf{p}=\hbar \mathbf{k}$), where $\mathbf{k}$ is the wave vector, the conservation law reads as:

\begin{equation}
w_{p}=w_{s}+w_{i}, \qquad \mathbf{k}_{p}=\mathbf{k}_{s}+\mathbf{k}_{i}, \label{conservation}
\end{equation}

where the sub-indices $p, i,s$ refer to pump, signal and idler respectively. This is the name often used in the literature for each of the photons in the process. Pump refers to the photons of the laser beam. The signal term concerns the photon that undergoes the physical process under consideration, while the idler one is attributed to the second photon that witnesses the presence of the first one.

There are three types of SPDC, namely, type-0, type-I, and type-II. Each type of SPDC is defined by the polarization of all the photons involved in the process. Thereby, in type-0 SPDC, all converted photons have the same polarization which is the same as the pump's annihilated photon.

\begin{figure}[h!]
\centering
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=2.8 cm]{images/TypeI.jpg}
\caption{SPDC type I}
\label{fig:type1}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=2.8 cm]{images/typeII.jpg}
\caption{SPDC type II}
\label{fig:type2}
\end{subfigure}
\caption{An Illustration Of the SPDC type I and II processes, a laser incident on a non-linear crystal and photons coming out of it along cones}
\label{fig:SPDC}
\end{figure}

Next, in type-I, both converted photons have the same polarization, which is orthogonal to that of the pump beam. In this kind of SPDC, both photons travel along the same cone\footnote{Photons come out of the crystal in a cone shape, this is a spontaneous process and a given photon can be anywhere on the cone}.

Finally, in SPDC type-II the polarization of converted photons are orthogonal, one of them the signal is the same polarization as the pump's. In this type of SPDC, each photon travels along its cone.

In this work, we are mainly concerned with the type-I SPDC process.

We will start our description of the SPDC process by considering the quantized electric field operator which can be written as:

\begin{align}
\textbf{E}(\textbf{r},t)&=\textbf{E}^{(+)} (\textbf{r},t) + \textbf{E}^{(-)} (\textbf{r},t), \label{fiel+}
\end{align}

with

\begin{align}
\textbf{E}^{(+)} (\textbf{r},t)&=\frac{i(2 \pi \hbar w)^{\frac{1}{2}}}{\sqrt{V}} \sum_{\textbf{k},\nu}  \mathbf{a}_{\textbf{k},\nu} \mathbf{e}_{\textbf{k},\nu} e^{i(\textbf{k.r}-wt)}=[\textbf{E}^{(-)} (\textbf{r},t)]^{\dagger}, \label{quanfield}
\end{align}

where $w$ is the frequency of the electric field, $\mathbf{k}$ is the wave vector of all modes with defined linear momenta, we sum over this modes and polarizations as part of the canonical quantization process where we make a spatial Fourier expansion \cite{grynberg} \footnote{These $\mathbf{k}$ are the normal modes,}, $\mathbf{e}_{\textbf{k},\nu}$ where $\nu=1,2$, is the polarization vector for a normal mode of wave vector $\mathbf{k}$ and defined polarization labeled by $\nu$, $\mathbf{a}_{\textbf{k},\nu}$ is the photon annihilation operator of the mode with wave vector $\mathbf{k}$ and polarization given by $\nu$. Finally, $V$ is the quantization volume, when we quantize we consider a finite volume (Usually a cube) such that $k_{m}=\frac{2 \pi n_{m}}{L}$ where $m=x,y,z$ and $L$ is the length of said cube, the annihilation and creation operators must obey:

\begin{equation}
[\mathbf{a}_{\textbf{k},\nu},\mathbf{a^{\dagger}}_{\textbf{k},\nu}]=\delta_{\nu \nu'}\delta\textbf{k}\textbf{k'}.
\end{equation}

where $\delta$ is the Kronecker's delta. The creation and annihilation operators on the Fock basis act as:

\begin{equation}
    \mathbf{a}_{\textbf{k},\nu}\ket{n}=\sqrt{n}\ket{n-1},\qquad
    \mathbf{a}_{\textbf{k},\nu}\ket{n}=\sqrt{n+1}\ket{n+1}.\label{Fock}
\end{equation}

The field operator $\textbf{E}^{(+)} (\textbf{r},t)$ acting on $\ket{0}$ which means the absence of photons of wave vector $\mathbf{k}$ and polarization $\nu$ is given by:

\begin{equation}
\textbf{E}^{(+)} (\textbf{r},t)\ket{0}=0,
\end{equation}

 with the adjoint relation:

\begin{equation}
\bra{0}\textbf{E}^{(-)} (\textbf{r},t)=0.
\end{equation}

The Hamiltonian operator of a quantized electromagnetic field can be written as \cite{jackson}:

\begin{equation}
H=\frac{1}{2}\int_{V} d^{3}r (\mathbf{D \cdot E}+\mathbf{H \cdot B}),
\end{equation}

where $\textbf{D}$ and $\textbf{H}$ are the electric displacement and the magnetic field operators, respectively. These are given in terms of the electric field $\textbf{E}$ and the magnetic flux $\textbf{B}$ by means of the constitutive relations (with $\epsilon_{0} $ being, as usually, the permittivity and $\mu_{0}$ the permeability of free space):


\begin{align}
\textbf{D}= \epsilon_{0} \textbf{E}+\textbf{P},\\
\textbf{H}=\frac{\textbf{B}}{\mu_{0}}-\textbf{M},
\end{align}

where $\mathbf{P}$ is the electric polarization (the polarization) and $\mathbf{M}$ is the magnetic polarization (the magnetization) of the optical medium of interest (a non-linear crystal).In this work, we will neglect $\textbf{M}$ because we will assume that the laser beam is not as intense as to magnetize the crystal. Hence, the Hamiltonian becomes:

\begin{equation}
H=\frac{1}{2}\int_{V} d^{3}r \left(\epsilon_{0}\mathbf{E \cdot E}+\mathbf{E \cdot P}+\frac{\mathbf{B \cdot B}}{\mu_{0}} \right)
\end{equation}

 We will consider the polarization to have nonlinear components and the linear term to be included in a term we will call $H_{0}$, the zeroth order term or polar term is negligible , the main contributor to the process is the second-order term in the nonlinear expansion (the expression for this second-order polarization $P_{i}^{(2)}$ can be found in \cite{boyd} ) and this is the main term we are going to consider we will call it $H_{I}$ (we consider higher terms in polarization to be negligible):


\begin{align}
H_{0}&=\frac{1}{2}\int_{V} d^{3}r \left(\epsilon_{0}\mathbf{E \cdot E}+\mathbf{E} \cdot \mathbf{P^{(i)}}+\frac{\mathbf{B \cdot B}}{\mu_{0}} \right),\\
H_{I}&=\frac{1}{2} \int_{V} d^{3}r \textbf{E} \cdot \textbf{P}^{(2)}, \label{Hi}\\
P_{i}^{(2)} (\mathbf{r},t)&=\int_{0}^{\infty}dt_{1}\int_{0}^{\infty}dt_{2} \chi_{ijk}^{(2')}(t-t_{1},t-t_{2}) E_{j}(\textbf{r},t_{1}) E_{k}(\textbf{r},t_{2}), \label{polariza}
\end{align}

where $\chi_{ijk}^{(2')}$ is related to the second-order nonlinear susceptibility and represents the response of the medium to the second power of the electric field. By substituting Eq. \ref{polariza} in  Eq. \ref{Hi} and separating the field operators into its the creation and annihilation components the interaction Hamiltonian $H_{I}$ turns into (we drop the dependence of the fields so that the expression is more compact):

\begin{align*}
&H_{I}=\frac{1}{2} \int_{V}\int_{0}^{\infty}dt_{1}\int_{0}^{\infty}dt_{2} \chi_{ijk}^{(2')}(t-t_{1},t-t_{2}) \left( E_{i}^{(+)}E_{j}^{(+)}E_{k}^{(+)}+E_{i}^{(-)}E_{j}^{(+)}E_{k}^{(+)}\right.\\
&+ E_{i}^{(-)}E_{j}^{(-)}E_{k}^{(+)}+E_{i}^{(+)}E_{j}^{(-)}E_{k}^{(+)}+E_{i}^{(+)}E_{j}^{(+)}E_{k}^{(-)}+E_{i}^{(-)}E_{j}^{(+)}E_{k}^{(-)}\\
&+ \left.E_{i}^{(-)}E_{j}^{(-)}E_{k}^{(-)}+E_{i}^{(+)}E_{j}^{(-)}E_{k}^{(-)}  \right). \label{muchoscampos} \numberthis
\end{align*}

The SPDC process, as we mentioned before, involves the annihilation of one photon of the pump beam and the creation of two photons of lower frequency. The only terms of equation \ref{muchoscampos} which are compatible with such phenomenon are those including $E_{i}^{(+)}E_{j}^{(-)}E_{k}^{(-)}$ (according to Eq. \ref{fiel+} the label $(+)$ is associated with the annihilation of photons and $(-)$ to their creation) and its Hermitian conjugate describing the reverse process. The other terms represent processes that do not preserve energy  so they will not be considered:

\begin{equation}
H_{I}=\int_{V} d^{3}r \chi_{ijk}^{(2)}(w_{j},w_{k}) (E_{i}^{(+)}E_{j}^{(-)}E_{k}^{(-)})+\mathrm{H.C}, \label{Hi2}
\end{equation}

where  $\mathrm{H.C}$ means Hermitian conjugate and we redefined:

\begin{equation}
\chi_{ijk}^{(2)}(w_{j},w_{k})=\frac{1}{2}\int_{0}^{\infty}dt_{1}\int_{0}^{\infty}dt_{2} \chi_{ijk}^{(2')}(t-t_{1},t-t_{2}),
\end{equation}

this was done by remembering that the temporal dependence of the field operators that create photons is given by $e^{iwt}$ as can be seen from \ref{quanfield} so that $E^{(-)}(\mathbf{r},t_{1})=E^{(-)}(\mathbf{r})e^{iwt_{1}}$ and we have:

\begin{equation}
\chi_{ijk}^{(2)}(w_{j},w_{k})=\frac{1}{2}\int_{0}^{\infty}dt_{1}\int_{0}^{\infty}dt_{2} \chi_{ijk}(t-t_{1},t-t_{2})^{(2')} e^{i w_{j} t_{1}} e^{i w_{k} t_{2}},
\end{equation}

making a change of variable $t'=t-t_{1}$, $t''=t-t_{2}$ then $dt'=-dt_{1}$ and $dt''=-dt_{2}$ then:

\begin{equation}
\chi_{ijk}^{(2)}(w_{j},w_{k})=\frac{1}{2}\int_{0}^{-\infty}dt_{1}\int_{0}^{-\infty}dt_{2} \chi_{ijk}(t',t'')^{(2')} e^{iw_{j}(t-t')} e^{i w_{k} (t-t'')},
\end{equation}

\begin{equation}
\chi_{ijk}^{(2)}(w_{j},w_{k})=\frac{1}{2}\int_{0}^{\infty}dt_{1}\int_{0}^{\infty}dt_{2} \chi_{ijk}(t',t'')^{(2')} e^{-iw_{j}t')} e^{-iw_{k}t'')} e^{iw_{j}t} e^{iw_{k}t},
\end{equation}

we take the terms dependent in $t$ to be the new time dependence of the field operators so that all field operators are in the same time frame as the pump's, doing this we arrive at Eq. \ref{Hi2}.

Replacing the expressions for the fields in Eq. \ref{Hi2}, and now substituting $i,j,k$ for $s,i,p$ respectively, where $s,i,p$ refers to signal,idler and pump respectively, then approximating the sum to an integral (taking $V$ to $\infty$) we take $\sum_{\textbf{k}}\xrightarrow{}\frac{V}{(2\pi)^{3}}\int d^{3}k$ and $\delta \mathbf{k} \mathbf{k}' =\delta(\mathbf{k}-\mathbf{k}')$:

\begin{align*}
&H_{I}=\int d^{3}k_{p}\int d^{3}k_{s}\int d^{3}k_{i} \sum_{\nu_{p},\nu_{s},\nu_{i}}\chi_{ijk}^{(2)}(w_{p},w_{s},w_{i}) (\mathbf{e}_{k_{p},\nu_{p}})_{i} (\mathbf{e}_{k_{s},\nu_{s}})^{*}_{j} (\mathbf{e}_{k_{i},\nu_{i}})^{*}_{k} \\ & \times \mathbf{a}_{\nu_{p}}(\mathbf{k}_{p})\mathbf{a^{\dagger}}_{\nu_{s}}(\mathbf{k}_{s})\mathbf {a^{\dagger}}_{\nu_{i}}(\mathbf{k}_{i})e^{i(w_{s}+w_{i}-w_{p})t} \int_{V}d^{3}r e^{i \Delta\textbf{k} \cdot \textbf{r}}+\mathrm{H.C} , \label{jajaja}
\end{align*}

where we  have introduced:
\begin{align}
\Delta \textbf{k}&= \mathbf{k}_{p}-\mathbf{k}_{s}-\mathbf{k}_{i},\\
\chi_{ijk}^{(2)}(w_{p},w_{s},w_{i})&=\frac{-iV^{\frac{3}{2}}}{(2\pi)^9 }(2 \pi \hbar)^{\frac{3}{2}} (w_{p}w_{s}w_{i})^{\frac{1}{2}}\chi_{ijk}^{(2)}(w_{s},w_{i}) .
\end{align}

As polarizations are fixed in SPDC,each sum in the labels $\nu_{p},\nu_{s},\nu_{i}$ contains only one term. Also we will consider $\chi_{ijk}^{(2)}(w_{p},w_{s},w_{i})$ to vary so slowly (in $\mathbf{k}$ and $\mathbf{r}$) that we can treat it as a constant over the integrals. We will define $\chi= \chi_{ijk}^{(2)}(w_{p},w_{s},w_{i}) (\mathbf{e}_{k_{p},\nu_{p}})_{i} (\mathbf{e}_{k_{s},\nu_{s}})^{*}_{j} (\mathbf{e}_{k_{i},\nu_{i}})^{*}_{k}$ so we can write:

\begin{align*}
   & H_{I}=\chi \int d^{3}k_{p}\int d^{3}k_{s}\int d^{3}k_{i}\int_{V} d^{3}r \mathbf{a}_{\nu_{p}}(\mathbf{k}_{p})\mathbf{a^{\dagger}}_{\nu_{s}}(\mathbf{k}_{s})\mathbf {a^{\dagger}}_{\nu_{i}}(\mathbf{k}_{i})e^{i(w_{s}+w_{i}-w_{p})t} \\& e^{i \Delta\textbf{k} \cdot \textbf{r}}+\mathrm{H.C}. \numberthis{}
\end{align*}


In the interaction picture\footnote{$H_{0}$ is the electromagnetic field Hamiltonian, which is proportional to the number operator and only adds a global phase to the evolution of this state which we can ignore (Coherent states evolve to coherent states \cite{gerry})}. The evolution of the state of the system is given by the equation:


\begin{align}
i \hbar \frac{d}{dt}\ket{\psi(t)}&=H_{I}\ket{\psi(t)}.\\
\label{a}
\end{align}

As this is a first order equation, the state of the system $\ket{\Psi(t)}$ is completely determined by the initial condition, say $\ket{\Psi(t_{0})}$ in this way we may write:

\begin{equation}
    \ket{\psi(t)}=U(t,t_{0})\ket{\psi(t_{0})},
\label{b}
\end{equation}

where $U(t,t_{0})$ is known as the evolution operator it encodes the dynamics of the system in the interval $[t_{0},t]$. Substituting Eq. \ref{b} in Eq. \ref{a} and applying the Leibniz rule, because the equation must be valid for any ket, one arrives to:

\begin{align}
i \hbar \frac{d}{dt}U(t,t_{0})=H_{I}U(t,t_{0}).
\end{align}

It is well known that the solution to this initial value problem can be expressed  as an iterative integral equation by direct integration,  which is commonly known as Dyson series, Moreover according to \ref{b}, the evolution operator $U(t,to)$ must satisfy the initial condition $U(t_{0},t_{0})=1$, thus up to first order in $H_{I}$, we have:

\begin{equation}
U(t,to)=\mathbf{1}-\frac{i}{\hbar} \int_{t_{0}}^{t} H_{I} (\tau) d\tau=\mathbf{1}+U_{1}
\end{equation}

We will not consider higher orders mainly for two reasons: one is that we are mainly interested in the SPDC process as a single photon states source (second-order would generate 4 photons), the second one is that higher orders are unlikely because the laser pump is not as  intense as for four photons to be produced in the crystal at once.

Now, in order to analyze the evoltion of the system in the SPDC process we need to identify the initial state. Knowing that, initially we have a pump  laser beam  and no photons or signal or idler, we identify the initial state as composed a coherent state in the input channel and vacuum states of the quantized electromagnetic field in the output channels, as the pump beam is in a coherent state \cite{leonhardt}, it may be written in the form:

\begin{equation}
\ket{\alpha}=e^{\frac{-|\alpha|^{2}}{2}} \sum_{n=0}^{\infty} \frac{\alpha^{n}}{\sqrt{n!}} \ket{n},
\end{equation}

where $\alpha$ is known as the complex wave amplitude  and $\ket{n}$ are the Fock or ``photon number states" of the electromagnetic field. Coherent states are eigenstates of the annihilation operator with eigenvalue $\alpha\in \mathrm{C}$
\begin{equation}
\hat{\mathbf{a}}\ket{\alpha}=\alpha\ket{\alpha}
\end{equation}

Fullfiling the following properties:

\begin{align}
\langle H \rangle = \hbar w \left(|\alpha|^{2}+\frac{1}{2}\right),\qquad P_{n}=e^{-\langle n\rangle}\frac{\langle n \rangle^{n}}{n!},
\end{align}

where $P_{n}$ is the probability of finding $n$ photons in a measurement of the coherent state. It can be checked that this corresponds to a Poisson distribution so that the coherent state  obeys Poissonian statistics.

Thus our initial state can be cast in the form $\ket{\psi(t_{0})}=\ket{\alpha_{p},0_{s},0_{i}}$, where the labels $p,s,i$ stand for the pump, signal and idler channels. Let us analyze the action of the second order term of the Dyson series  $U_{1}$ on the initial state:

\begin{align*}
 &U_{1}\ket{\psi(t_{0})}=\frac{-i \chi}{\hbar}  \int_{t_{0}}^{t} d\tau \int d^{3}k_{p}\int d^{3}k_{s}\int d^{3}k_{i}\int_{V} d^{3}r \alpha_{p} (\mathbf{k}_{p},w_{p})\\ &e^{i(w_{s}+w_{i}-w_{p})\tau}e^{i \Delta\textbf{k}.\textbf{r}}\ket{\alpha_{p},1_{s},1_{i}} , \numberthis{}\label{t1}
\end{align*}


In the last expressions, we already used the expressions in Eqs. \ref{Fock}  concerning the action of the ladder operators on the initial state. Note that the initial state is annihilated under the action of the term $\mathrm{H.C}$ in Eq. \ref{jajaja}.  If we define 

\begin{equation}
 \xi(t,t_{0})=\frac{-i\chi}{\hbar}  \int d^{3}k_{p}\int d^{3}k_{i} \int d^{3}k_{s}    \int_{t_{0}}^{t} d\tau e^{i(w_{s}+w_{i}-w_{p})\tau}  
\int_{V} d^{3}r  e^{i \Delta\textbf{k} \cdot\textbf{r}} ,
\end{equation}



we can then rewrite Eq. \ref{t1} as:

\begin{equation}
U_{1}(t,t_{0})\ket{\alpha_{p},0_{s},0_{i}}=\xi(t,t_{0}) \mathbf{a_{p}}\mathbf{a_{s}^{\dagger}}\mathbf{a_{i}^{\dagger}}\ket{\alpha_{p},0_{s},0_{i}}=\xi(t,t_{0}) \alpha_{p} \ket{\alpha_{p},1_{s},1_{i}}.
\end{equation}

Finally we may write

\begin{equation}
    U(t,t_{0})=\mathbf{1}+\xi(t,t_{0}) \mathbf{a_{p}}\mathbf{a_{s}^{\dagger}}\mathbf{a_{i}^{\dagger}}. \label{evo}
\end{equation}

In this section we developed some of the basics of the quantum theory of the SPDC process. In the next section we will use this theory to explore spatial correlations between the idler a signal photons.

\section{First order joint amplitude function}

Now that we have presented a quantum mechanical description of the phenomenon, we will describe how it can be used to generate single-photon states. We will use the model proposed by O.Rosas-Ortiz and L.M Procopio in \cite{procopio} in order to set the design for our experiment. Most if not all information concerning the spatial correlations is encoded in the joint amplitude function, which is the aim of the present section. Considering the first order approach to the evolution operator Eq. \ref{evo} we have:

\begin{equation}
    U(t)=\mathbf{1}+\xi(t) \mathbf{a_{p}}\mathbf{a_{s}^{\dagger}}\mathbf{a_{i}^{\dagger}}, 
\end{equation}

where we have set $t_{0}=0$, $\xi(t,0)=\xi(t)$ and $U(t,0)=U(t)$. So our final state can be calculated by:

\begin{align*}
\ket{\psi(t)}&=U(t)\ket{\psi(t_{0})},\numberthis{}\\
&=\ket{\alpha_{p},0_{s},0_{i}}-\frac{i \chi}{\hbar}  \int_{t_{0}}^{t} d\tau \int d^{3}k_{p}\int d^{3}k_{s}\int d^{3}k_{i}\int_{V} d^{3}r \alpha_{p} (\mathbf{k}_{p},w_{p})\\ &e^{i(w_{s}+w_{i}-w_{p})\tau}e^{i \Delta\textbf{k}.\textbf{r}}\ket{\alpha_{p},1_{s},1_{i}}  \numberthis{}
\end{align*}

We will rewrite this as:

\begin{equation}
\ket{\psi(t)}=\ket{\alpha_{p},0_{s},0_{i}}-\frac{i\chi}{\hbar} \int d^{3}k_{s}\int d^{3}k_{i}
\Phi(\mathbf{k}_{i},w_{i},\mathbf{k}_{s},w_{s})\ket{\alpha_{p},1_{s},1_{i}},
\end{equation}

where we conveniently defined $\Phi$:

\begin{equation}
\Phi(\mathbf{k}_{i},w_{i},\mathbf{k}_{s},w_{s})=\int d^{3}k_{p} \alpha_{p}(\mathbf{k}_{p},w_{p}) \int_{V} d^{3}r e^{i \Delta \mathbf{k}.\mathbf{r}} \int_{t_{0}}^{t} d\tau e^{i(w_{s}+w_{i}-w_{p})\tau}.\label{joint}
\end{equation}

This $\Phi$ function is what is known in the current literature as the joint amplitude function, this one is the first order because we stopped the Dyson series at first order. This function will enable us to study spatial correlations of the signal and idler channel in the next section.

\section{Spatial correlations}

Let us now study the spatial correlations from the joint amplitude function, to do this a couple of approximations will be made.
Considering steady state fields and that the dimensions of the nonlinear crystal are much larger than the wavelength of the pump we consider $V\xrightarrow{}\infty$:


\begin{align*}
&\int_{t_{0}}^{t} d\tau e^{i(w_{s}+w_{i}-w_{p})\tau} \xrightarrow{}
\int_{-\infty}^{\infty} d\tau e^{i(w_{s}+w_{i}-w_{p})\tau}= 2\pi \delta(w_{s}+w_{i}-w_{p}) \label{t2},\\
&\int_{V} d^{3}r  e^{i \Delta\textbf{k} \cdot\textbf{r}} \xrightarrow{} \int_{-\infty}^{\infty} d^{3}r  e^{i \Delta\textbf{k} \cdot \textbf{r}}=(2 \pi)^{3}  \delta(\mathbf{k}_{p}-\mathbf{k}_{s}-\mathbf{k}_{i}) .
\label{t2} \numberthis{}
\end{align*}

Implementing such approximations the Eq. \label{joint} becomes:

\begin{equation}
\Phi(\mathbf{k}_{i},w_{i},\mathbf{k}_{s},w_{s})= \eta \alpha_{p}(\mathbf{k}_{s}+\mathbf{k}_{i},w_{s}+w_{i}) .
\end{equation}


Let us assume  $\alpha_{p}$ can be factorized into two functions, one that depends on the wave vectors, and one that depends on the frequencies:

\begin{equation}
\Phi(\mathbf{k_{i}},w_{i},\mathbf{k_{s}},w_{s})= \eta G(\mathbf{k}_{i}+\mathbf{k}_{s}) F(w_{s}+w_{i}) .
\end{equation}
 
We  will now separate the wave vectors into their transversal and longitudinal components:

\begin{equation}
\mathbf{k}_{r}=\mathbf{q}_{r}+k_{rz} \mathbf{e}_{rz},\mathbf{q}_{r}=q_{rx} \mathbf{e}_{rx}+q_{ry} \mathbf{e}_{ry},
\end{equation}

where $r=p,s,i$. We will assume the paraxial approximation to be valid,  as Molina-Terriza and Minardi \cite{minardi} demonstrated that in this situation the transversal components are negligeable with respect to the longitudinal one. Let us assume that both functions G and F are Gaussian so that:

\begin{equation}
G(\mathbf{A})=e^{- (\sigma \abs{\mathbf{A}})^{2} },\qquad F(w)=e^{-(\delta w)^2}.
\end{equation}

Using this we can rewrite the joint amplitude function as:

\begin{equation}
\Phi(\mathbf{q}_{i},w_{i},\mathbf{q}_{s},w_{s})= \eta e^{-\sigma^{2}\abs{\mathbf{q_{s}}+\mathbf{q_{i}}}^{2}} F(w_{s}+w_{i}).\label{true}
\end{equation}

The spatial and spectral sensitivity of the detector are assumed to be given by Gaussian profile filters:

\begin{equation}
\mathbb{F}_{s}(\mathbf{q}_{r})=e^{-\abs{\mathbf{\sigma}.\mathbf{q}_{r}}^{2}},\qquad \mathbb{F}_{f}(w_{r})=e^{-(\alpha_{r} w_{r})^{2}}. \label{filter}
\end{equation}

Here $\mathbf{\sigma}=(\sigma_{rx},\sigma_{ry})$, and $\alpha_{r}$, correspond to the spatial and frequency collection modes respectively, the physical process is modeled by Eq. \ref{true}, however, our detectors and filters are only efficient up to a certain point, in order to account for it we multiply our filter's response Eq. \ref{filter} to our process so we can write:
 
\begin{equation}
\Phi(\mathbf{q}_{i},w_{i},\mathbf{q}_{s},w_{s})=\Phi_{f}(w_{i},w_{s})\Phi_{s}(\mathbf{q}_{i},\mathbf{q}_{s}).
\end{equation}

That way separating it into two functions, one that tells us about the frequencies  and the other one tells us about the spatial correlations:

\begin{equation}
\Phi_{f}(w_{s},w_{i})= \eta F_{p}(w_{s}+w_{i}) \mathbb{F}_{f}(w_{i})\mathbb{F}_{f}(w_{s})
\end{equation}

\begin{equation}
 \Phi_{s}(\mathbf{q}_{i},\mathbf{q}_{s})=e^{-\sigma^{2}\abs{\mathbf{q}_{s}+\mathbf{q}_{i}}^{2}}\mathbb{F}_{s}(\mathbf{q}_{s})\mathbb{F}_{s}(\mathbf{q}_{i}).
\end{equation}

Since we are in momentum space, we can obtain the spatial correlations by taking the Fourier transform:

\begin{equation}
\Phi_{s}(\mathbf{q}_{i},\mathbf{q}_{s})=\mathscr{F}(\Phi_{s}(\mathbf{q}_{i},\mathbf{q}_{s}))=N \int d^{2}q_{i} \int d^{2}q_{s} \Phi_{q}(\mathbf{q}_{i},\mathbf{q}_{s}) e^{-i \mathbf{q}_{s}.\mathbf{r}_{s}} e^{-i \mathbf{q}_{i}.\mathbf{r}_{i}}.
\end{equation}

\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/SPDC_yy.png}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/SPDC_xx.png}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/SPDC_yx.png}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/SPDC_xy.png}
\end{subfigure}
\caption{Plots for the spatial part of the joint amplitude function}
\label{SPDC}
\end{figure}

This last equation encodes all spatial correlations between the signal and idler photon channels, allowing us to use this scheme to produce single-photon states, by measuring in two positions which are highly correlated and only taking into account measurements where both detectors(one placed in the signal channel and the other in the idler channel) click, ensuring that this process took place and we indeed have single-photon states. Plots for $\Phi_{s}(x_{i},y_{i},x_{s},y_{s})$ can be seen in Fig. \ref{SPDC} where, from left to right are $x_{s}=x_{i}=0$, $y_{s}=y_{i}=0$, $x_{i}=y_{s}=0$ and $y_{i}=x_{s}=0$


\chapter{The lossless beam splitter}

\begin{figure}[h!]
\centering
\includegraphics[width=5 cm,height=5 cm]{images/bS.png}
\caption{A Beam splitter cube}
\label{fig:BS}
\end{figure}

In this chapter, we will develop both the classical and quantum theory of the most important optical element in this thesis, the beam splitter. The beam splitter is a four-port optical device with two inputs and two outputs as shown in Fig. \ref{fig:BS} two input beams may interfere to produce two outgoing beams. A beam splitter is usually a dielectric interface that is birefringent inside a cube as Fig. \ref{fig:BS} shows.

\section{The  classical lossless beam splitter}
This section is inspired in the beam splitter description presented in \cite{ludon} and \cite{leonhardt}, we are assuming monochromatic light  (only one mode), in this thesis, we will consider ideal beam splitters which are reversible and lossless devices.


When we talk about a laser beam in classical electrodynamics we express it as an electric field, when going through a linear medium the outgoing fields can be written as a linear combination of the input fields satisfying boundary conditions \cite{jackson}. As we are dealing with 2 inputs and two outputs this can be written as:

\begin{equation}
\begin{pmatrix} E_{1}' \\ E_{2}' \end{pmatrix}=B\begin{pmatrix} E_{1} \\ E_{2} \end{pmatrix},
\end{equation}

the linear transformation $B$ is described by a matrix:

\begin{equation}
B=\begin{pmatrix} B_{11}& B_{12} \\B_{21} & B_{22} \end{pmatrix}.
\end{equation}

Conditions on the coefficients on this matrix can be found by asking for the total intensity to be conserved (since it is lossless this should be fulfilled), that is:

\begin{align}
&I_{1}'+I_{2}'=I_{1}+I_{2}, \\
&I_{1}'\propto|B_{11} E_{1}|^{2}+|B_{12} E_{2}|^{2}+B_{11} B_{12}^{*} E_{1} E_{2}^{*}+B_{11}^{*} B_{12} E_{1}^{*} E_{2}, \\
&I_{2}'\propto|B_{21} E_{1}|^{2}+|B_{22} E_{2}|^{2}+B_{21} B_{22}^{*} E_{1} E_{2}^{*}+B_{21}^{*} B_{22} E_{1}^{*} E_{2},\\
&|E_{1}|^{2}+|E_{2}|^{2}=(|B_{21}|^{2}+|B_{11}|^{2})|E_{1}|^{2}+(|B_{12}|^{2}+|B_{22}|^{2})|E_{2}|^{2}+\\
&(B_{21} B_{22}^{*}+B_{11} B_{12}^{*})E_{1} E_{2}^{*}+(B_{21}^{*} B_{22}+B_{11}^{*} B_{12})E_{1}^{*} E_{2}.
\end{align}

So from conservation of intensity (energy) we obtain the following relationships:

\begin{align}
&|B_{12}|^{2}+|B_{22}|^{2}=|B_{21}|^{2}+|B_{11}|^{2}=1,\\
&B_{21}^{*} B_{22}+B_{11}^{*} B_{12}=0.
\end{align}

From these relations, it follows that the matrix $B$ is unitary. From these set of equations one can derive yet another constraint on the coefficients $B_{21}* B_{11}+B_{22}* B_{12}=0$ can be obtained this is because $B^{\dagger}B=B^{\dagger}B= \mathbf{1}$. We will write this matrix in terms of the reflectivity $\rho$ and the transmissivity $\tau$ that follow the relationship:

\begin{equation}
|\tau|^{2}+|\rho|^{2}=1.
\end{equation}
 
 In the classical case the transformation is usually written as:
 
 \begin{equation}
 B=\begin{pmatrix} \tau & \rho \\ -\rho & \tau \end{pmatrix}.
 \end{equation}


so that

\begin{equation}
\begin{pmatrix} E_{1}' \\ E_{2}' \end{pmatrix}=\begin{pmatrix} \tau & \rho \\ -\rho & \tau \end{pmatrix} \begin{pmatrix} E_{1} \\ E_{2} \end{pmatrix}.
\end{equation}




\section{The quantum lossless beam splitter}

We will now develop the quantum theory of a lossless beam splitter. To do this we will first quantize the electric field and then build the theory. It should not be a surprise that we obtain the same theory as in the case of the classical beam splitter because it is quite typical that classical laws rule interference phenomena, going quantum often only affects the visibility, but does not modify the theory \cite{Leonhardt_2003}.


The  electric field can be written as:

\begin{equation}
\mathbf{E}=i \mathbf{\epsilon}N w \left( \alpha e^{i (\mathbf{k \cdot r}-w t)}+\alpha^{*} e^{-i (\mathbf{k \cdot r}-w t)} \right),
\end{equation}

Where $\alpha$ is known as the complex wave amplitude, to make our theoretical model of a beam splitter as general as possible, let us describe the device as a four-port device, a black box with two input and two output ports having certain properties.

If two coherent light beams with complex wave amplitudes $\alpha_{1}$ and $\alpha_{2}$ enter the beam splitter we simply expect the output complex wave amplitude  are superimposed according to a linear transformation that we will call $B$ so that:

\begin{equation}
\begin{pmatrix} \alpha_{1}' \\ \alpha_{2}' \end{pmatrix}=B\begin{pmatrix} \alpha_{1} \\ \alpha_{2} \end{pmatrix}.
\end{equation}

When we quantize the electric field the complex wave amplitude $\alpha$ is promoted to a ladder operator. Once quantized this becomes:

\begin{equation}
\begin{pmatrix} \mathbf{a}_{1}' \\ \mathbf{a}_{2}' \end{pmatrix}=B\begin{pmatrix} \mathbf{a}_{1} \\ \mathbf{a}_{2} \end{pmatrix}.
\label{eq:amplitudes}
\end{equation}

As this equation describes the change of the ladder operators in the process, it corresponds to the Heisenberg picture. Assuming the incoming and outgoing beams are both independent bosonic modes, we can obtain some properties of the $B$ matrix because the ladder operators must obey:

\begin{align}
&[\mathbf{a}'_{\nu},\mathbf{a}'_{\mu}]=[\mathbf{a}_{\nu},\mathbf{a}_{\mu}]=0,\\
&[\mathbf{a}'_{\nu},\mathbf{a}'^{\dagger}_{\mu}]=[\mathbf{a}_{\nu},\mathbf{a}^{\dagger}_{\mu}]=\delta_{\mu \nu},
\label{commutators}
\end{align}

where $\mu=0,1$ and $\vu=0,1$. From Eq.\ref{eq:amplitudes} it follows that:

\begin{align}
&\mathbf{a}'_{\mu}=B_{\mu 1}\mathbf{a}_{1}+B_{\mu 2} \mathbf{a}_{2}, \\
&\mathbf{a}'^{\dagger}_{\mu}=B_{\mu 1}^{*}\mathbf{a}^{\dagger}_{1}+B_{\mu 2}^{*} \mathbf{a}^{\dagger}_{2}.
\label{combined amplitudes}
\end{align}

Then we use the commutation relations to find constraints on the elements of the $B$ matrix, using Eq. \ref{combined amplitudes} and Eq. \ref{commutators} we find that:

\begin{equation}
   [\mathbf{a}'_{\nu},\mathbf{a}'^{\dagger}_{\mu}]=B_{\nu 1} B_{\mu 1}^{*}+B_{\nu 2} B_{\mu 2}^{*} .
\end{equation}

Substituting for all possible values of $\nu$ and $\mu$ we find the following relationships:

\begin{equation}
|B_{11}|^{2}+|B_{12}|^{2}=|B_{21}|^{2}+|B_{22}|^{2}=1 ,\qquad B_{11} B_{21}^{*}+B_{12} B_{22}^{*}=0.
\end{equation}

Which indicate that the B transformation is unitary, something we expected of a lossless device. The most general form of a unitary $2\times2$ matrix is \cite{leonhardt}:


\begin{equation}
B=e^{\Lambda} \begin{pmatrix} e^{i\frac{\phi}{2}} & 0 \\ 0 & e^{-i\frac{\phi}{2}} \end{pmatrix} \begin{pmatrix} \cos(\theta) &  \sin(\theta) \\ - \sin(\theta) & \cos(\theta) \end{pmatrix} \begin{pmatrix} e^{i\frac{\psi}{2}} & 0 \\ 0 & e^{-i\frac{\psi}{2}} \end{pmatrix} \label{unitary},
\end{equation}

Note that our analysis so far is valid for any lossless four-port linear device, furthermore from Eq. \ref{unitary} we can see that any four-port device can be considered as acting in three steps \footnote{A phase shifter is denoted by $P_{\phi}=e^{i \frac{\phi}{2}}\begin{pmatrix}e^{i \frac{\phi}{2}} & 0 \\0 & e^{-i \frac{\phi}{2}} \end{pmatrix}$}. First the phases of the incident modes are changed, then the amplitudes are mixed (rotated) and then the phases change again. In most cases we can adjust the reference phases such that only the rotation is important, so this is the key feature of four-ports, that is why from now on we will parametrize our beam splitter ($BS$) as (this corresponds to $\Lambda=0$,$\phi=-\psi=\frac{\pi}{2}$):


\begin{equation}
BS=\begin{pmatrix} \cos(\theta) & i \sin(\theta) \\ i \sin(\theta) & \cos(\theta) \end{pmatrix}.
\end{equation}


Let us now analyze this optical element in the Fock basis. In the Heisenberg picture operators evolve via the evolution operator:

\begin{equation}
\begin{pmatrix} \mathbf{a}'_{1} \\ \mathbf{a}'_{2}\end{pmatrix}=\mathbf{U}^{\dagger}_{B} \begin{pmatrix} \mathbf{a}_{1} \\ \mathbf{a}_{2}\end{pmatrix} \mathbf{U}_{B}.
\label{Heisenberg}
\end{equation}

A Fock state $\ket{n_{1},n_{2}}$ can be generated from a vacuum state. Note that when one of the inputs does not have a beam what enters the beam splitter is a vacuum state $\ket{0,0}$:

\begin{equation}
 \ket{n_{1},n_{2}}=\frac{1}{\sqrt{n_{1}! n_{2}!}} \mathbf{a}^{\dagger}^{n_{1}}_{1}\mathbf{a}^{\dagger}^{n_{2}}_{2} \ket{0,0}.
\end{equation}

In the Schrodinger picture a vacuum state evolves by (Note that in this picture operators do not evolve states do so $\mathbf{a}=\mathbf{a'}$):

\begin{equation}
 \ket{\psi}'=U_{B}\ket{\psi}, \qquad
 \ket{0,0}'=U_{B}\ket{0,0}.
 \label{evolution}
\end{equation}

So now let us see the evolution of a $\ket{n_{1},n_{2}}'$:

\begin{align}
&\ket{n_{1},n_{2}}'=U_{B}\ket{n_{1},n_{2}},\\
&\ket{n_{1},n_{2}}'=\frac{U_{B}}{\sqrt{n_{1}! n_{2}!}} \mathbf{a}'^{\dagger}^{n_{1}}_{1}\mathbf{a}'^{\dagger}^{n_{2}}_{2} \ket{0,0}.
\end{align}

From Eq. \ref{Heisenberg}, Eq. \ref{eq:amplitudes} and Eq. \ref{evolution} we can obtain:

\begin{align}
&\ket{n_{1},n_{2}}' =\frac{U_{B}}{\sqrt{n_{1}! n_{2}!}} \mathbf{a}'^{\dagger}^{n_{1}}_{1}\mathbf{a}'^{\dagger}^{n_{2}}_{2} U^{\dagger}_{B}\ket{0,0}',\\
&\ket{n_{1},n_{2}}' =\frac{1}{\sqrt{n_{1}! n_{2}!}} \mathbf{a}^{\dagger}^{n_{1}}_{1}\mathbf{a}^{\dagger}^{n_{2}}_{2}\ket{0,0}'.
\end{align}

By writing the original ladder operators in terms of the transformed ladder operators, and applying Newton's binomial formula (we can do this because the operators commute in general this cannot be done) we arrive at the ``compact'' expression \footnote{ The binomial coefficient is $\begin{pmatrix} n \\ k \end{pmatrix} =\frac{n!}{\sqrt{k!(n-k)!}}$}:

\begin{align*}
\ket{n_{1},n_{2}}'& =\frac{1}{\sqrt{n_{1}! n_{2}!}} (B_{11}\mathbf{a}_{1}'^{\dagger}+B_{21}\mathbf{a}_{2}'^{\dagger})^{n_{1}}(B_{12}\mathbf{a}_{1}'^{\dagger}+B_{22}\mathbf{a}_{2}'^{\dagger})^{n_{2}}\ket{0,0}',\\
\ket{n_{1},n_{2}}'&=\frac{1}{\sqrt{n_{1}! n_{2}!}}\sum^{n_{1},n_{2}}_{k_{1},k_{2}=0}\begin{pmatrix} n_{1} \\ k_{1} \end{pmatrix}\begin{pmatrix} n_{2} \\ k_{2} \end{pmatrix} B_{11}^{n_{1}-k_{1}} B_{21}^{k_{1}} B_{12}^{n_{2}-k_{2}} B_{22}^{k_{2}} \\
\times &\sqrt{(n_{1}+n_{2}-k_{1}-k_{2})!(k_{1}+k_{2})!} \ket{n_{1}+n_{2}-k_{1}-k_{2},k_{1}+k_{2}}' .\numberthis{}
\end{align*}

Now let us consider one of the inputs is vacuum that is $n_{2}=0$ and $n_{1}=n$  and vice-versa (from now on we will drop the primes in the right hand side, we know it is the state in the output):
\begin{align}
 \ket{n,0}'=\sum^{n}_{k=0} \sqrt{\frac{n!}{(n-k)!k!}} B_{11}^{n-k} B_{21}^{k} \ket{n-k,k},\\
     \ket{0,n}'=\sum^{n}_{k=0} \sqrt{\frac{n!}{(n-k)!k!}} B_{12}^{n-k} B_{22}^{k} \ket{n-k,k}.
\end{align}

In this work we intend to work with single-photons, so that our case of interest is $n=1$,we run the sum to obtain:

\begin{align}
\ket{1,0}'=B_{11}\ket{1,0}+B_{21}\ket{0,1}, \\
\ket{0,1}'=B_{12}\ket{1,0}+B_{22}\ket{0,1}.
\label{basis}
\end{align}


From Eq. \ref{basis} we can see that the case of the single-photon can be written in terms of the $BS$ matrix if we define an appropriate basis to describe the system. The one we will use is the Horizontal-Vertical computational basis. We will use:

 \begin{equation}
 \ket{1}=\ket{1}_{h}\ket{0}_{v}=\begin{pmatrix} 1 \\0\end{pmatrix},
 \end{equation}

 meaning one photon in the horizontal path and vacuum in the vertical path
 
 \begin{equation}
 \ket{2}=\ket{0}_{h}\ket{1}_{v}=\begin{pmatrix} 0 \\1 \end{pmatrix},
 \end{equation}
 
meaning vacuum  in the horizontal path and one photon in the vertical path, so then Eq. \ref{basis} become:
\begin{equation}
\ket{out}=\begin{pmatrix} \cos(\theta) & i \sin(\theta) \\ i \sin(\theta) & \cos(\theta) \end{pmatrix} \ket{in},
\end{equation}

where $\ket{in}=\ket{1},\ket{2}$ and out is a linear combination of the vectors $\ket{1},\ket{2}$. A mirror in this basis(Horizontal-Vertical) simply flips the state and adds a phase, so we have no recombination of the amplitudes taking Eq. \ref{unitary} with $\theta=\frac{\pi}{2}$,$\phi=\pi$,$\Lambda=\gamma$ and $\psi= \frac{\pi}{2} $ we get:

 
\begin{equation}
M=\begin{pmatrix} 0& e^{i\gamma}  \\ e^{i\gamma} & 0 \end{pmatrix}.
\end{equation}

We have now defined all the things we need to analyze the interferometer in the classical and quantum case, which we will do in the next chapter

\pagebreak
\chapter{The Mach-Zehnder interferometer }


 The Mach–Zehnder's flexibility in locating the fringes has made it the preferred interferometer for visualizing flow in wind tunnels \cite{10} and for flow visualization studies in general. It is frequently used in several fields such as aerodynamics, plasma physics, and heat transfer to measure pressure, density, and temperature changes in gases \cite{11}, they are also used in electro-optic modulators \cite{ackerman}, electronic devices used in various fiber-optic communication applications. Mach–Zehnder modulators are incorporated in monolithic integrated circuits and offer well-behaved \cite{studenkov}, high-bandwidth electro-optic amplitude, and phase responses over a multiple-gigahertz frequency range \cite{capmany}.

The Mach-Zehnder interferometer consists of two Beam Splitters ($BS_{1}$ and $BS_{2}$) and two mirrors ($M_{1}$ and $M_{2}$). Two detectors $D_{1}$ and $D_{2}$ are placed in the output of the second beam splitter $BS_{2}$ as shown in Fig. \ref{fig:classical mach}. The idea is to get an interference pattern from just one incoming beam which is divided by $BS_{1}$ then each arm is redirected by mirrors $M_{1}$ and $M_{2}$ to be recombined by the second beam splitter $BS_{2}$ into the outgoing beams $E_{1}^{'''}$ and $E_{2}^{'''}$ these output beams are detected in either $D_{1}$ or $D_{2}$ respectively. We will now analyze the interferometer both in the classical and quantum regimes.

\pagebreak
\begin{figure}[H]
\centering
\includegraphics[width=\linewidth]{images/machzenhdercla.png}
\caption{Mach-Zehnder Interferometer}
\label{fig:classical mach}
\end{figure}



\section{Classical Mach-Zehnder interferometer}

In this section, we study the Mach-Zehnder interferometer in the classical regime. We will denote the classical fields going through the interferometer as is shown in Fig. \ref{fig:classical mach}. We will follow the approach taken by Loudon \cite{ludon}. Let us consider two lossless beam splitters   $BS_{1}=BS_{2}$. The electric field $E_{1}$ of the incident beam is then split as:

\begin{equation}
E_{1}'=\tau E_{1} ,\qquad E_{2}'=\rho E_{1}.
\end{equation}

The mirrors described by the matrix $M$ only add a phase $e^{i\phi_{i}}$, where $i=1,2$. We can proceed to calculate the intensity of the fields in the output

\begin{equation}
 E_{1}''=e^{ik\phi_{1}}E_{1}', \qquad E_{2}''=e^{i k\phi_{2}}E_{2}'.
\end{equation}

Then those fields go through the second $BS$:

\begin{align*}
E_{1}'''=\tau E_{2}'' +\rho E_{1}'', \qquad E_{2}'''=\tau E_{1}'' -\rho E_{2}''. \numberthis
\end{align*}

Substituting the expressions obtained before the above equations can be written as :

\begin{align*}
E_{1}'''&=\tau \rho (e^{i k\phi_{1}}+ e^{i k\phi_{2}})E_{1},\\
E_{2}'''&=\tau^2 e^{i k\phi_{1}} E_{1} -\rho^2 e^{i k\phi_{2}}E_{1}.
 \numberthis
\end{align*}

We can calculate intensities at the detectors by taking the modulus squared of the fields, we use $\delta \phi=\phi_{1}-\phi_{2}$:

\begin{align*}
I_{D_{1}}& \propto \abs{E_{1}}^2 2(\rho \tau)^2(1+\cos(k\delta \phi)),\\
I_{D_{2}}& \propto \abs{E_{1}}^2 (\rho^4 +\tau^4)(1-\frac{2 (\rho \tau)^2}{\rho^4+\tau^4}\cos(k\delta \phi)). \numberthis
\end{align*}

A case of interest is when $\rho =\tau=\frac{1}{\sqrt{2}}$, then the intensities become:

\begin{align*}
I_{D_{1}} & \propto \abs{E_{1}}^2 \frac{1+\cos(k\delta \phi)}{2}, \\
I_{D_{2}} & \propto \abs{E_{1}}^2 \frac{1-\cos(k\delta \phi)}{2}. \numberthis
\end{align*}
 
 When  $\delta \phi=\lambda n$ where $n=1,2,3,...$, so $\cos(2 \pi n )=1$ and the detector $D_{1}$ receives the intensity of the initial beam and $D_{2}$ receives no light.
 
\begin{align}
I_{D_{1}}\propto \abs{E_{1}}^2, \qquad I_{D_{2}}\propto 0. \numberthis
\end{align}


\section{Single photon Mach-Zehnder interferometer}

In this section, we will study a single photon Mach-Zehnder, which will be the main object of concern for the rest of this thesis. for this part of the analysis, we will assume mirrors that induce different phases in each path. This is done to analyze misalignment and as proven in a later chapter, it is equivalent to considering phase-shifters inducing differences in the optical paths.

\begin{equation}
M_{i}= \begin{pmatrix} 0& e^{i\gamma_{i}} \\ e^{i\gamma_{i}} & 0 \end{pmatrix}.
\end{equation}

Once we have defined the main elements we can analyze the single-photon Mach-Zehnder interferometer. A single photon is generated via SPDC and is sent in the horizontal path of the interferometer as input, so $\ket{1}$ is our initial state which encounters the first $BS$

\begin{align}
\ket{1}\xrightarrow{\text{BS}}\cos(\theta)\ket{1}+i\sin(\theta)\ket{2}.
\numberthis
\end{align}

To study a general situation, we will consider two different $BS$ in our interferometer. Note that the action of optical elements is local. After the first $BS$, the photon encounters a mirror in each path, and then both paths are recombined in the second $BS$. The whole action of the interferometer on the initial state $\ket{1}$ is then:


\begin{align*}
&\ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2}\xrightarrow{\text{Mirrors}}\cos(\theta_{1})e^{i\gamma_{1}}\ket{2}+i\sin(\theta_{1})e^{i\gamma_{2}}\ket{1} \\ \xrightarrow{\text{BS2}}
 &i(\cos(\theta_{1})\sin(\theta_{2})e^{i\gamma_{1}}+\cos(\theta_{2})\sin(\theta_{1})e^{i\gamma_{2}})\ket{1}+\\&(\cos(\theta_{1})\cos(\theta_{2})e^{i\gamma_{1}}-\sin(\theta_{1})\sin(\theta_{2})e^{i\gamma_{2}})\ket{2}. \numberthis
\end{align*}


To compare with the classical case where we did our calculations with two identical $BS$ we make $\theta_{1}=\theta_{2}=\frac{\pi}{4}$ then the state at the output of the interferometer is

\begin{align*}
\ket{\psi}=\frac{i}{2}(e^{i\gamma_{1}}+e^{i\gamma_{2}})\ket{1}+\frac{1}{2}(e^{i\gamma_{1}}-e^{i\gamma_{2}})\ket{2}, \\
\ket{\psi}=\frac{e^{i(\gamma_{1}+\frac{\pi}{2})}}{2}(1+e^{i(\gamma_{2}-\gamma_{1})})\ket{1}+\frac{e^{i\gamma_{1}}}{2}(1-e^{i(\gamma_{2}-\gamma_{1})})\ket{2}. \numberthis
\end{align*}

To obtain the probabilities at the output we simply compute:
\begin{align}
P_{D_{1}}&=|\bra{1}\ket{\psi}|^{2}, \qquad &&P_{D_{2}}=|\bra{2}\ket{\psi}|^{2},\\
P_{D_{1}}&=\frac{1+\cos(\gamma_{2}-\gamma_{1})}{2}, \qquad &&P_{D_{2}}=\frac{1-\cos(\gamma_{2}-\gamma_{1})}{2}. \label{pp_wheler}
\end{align}

Perfect alignment means no difference in the optical path so that $\gamma_{2}-\gamma_{1}=0$, then the probability to detect in $D_{1}$ is one and in $D_{2}$ is zero, perfectly compatible with the result obtained in the classical case, we expect a similar result because the classical case is nothing but many repetitions of this case.

\chapter{``Interaction-free measurements''}

In this chapter we will explore what is known in the literature as interaction-free measurements or non-demolition measurements, these were proposed by Elitzur and Vaidman in \cite{Elitzur}, and have awoken a lot of discussion about the non-local nature of quantum theory as well as philosophical discussions about what quantum theory is\footnote{ This kind of discussions will be kept to a minimum in this thesis since they are way more philosophical than physical and highly speculative interesting discussions can be found in \cite{paper_vaidman, maudlin} }, this kind of measurements have found applications in imaging \cite{imaging}. We will now analyze the simplest case proposed by Elitzur and Vaidman

\section{Single-photon Mach-Zehnder interferometer with a perfect absorber}

This case is best known as the Elitzur-Vaidman's bomb detector \cite{Elitzur}, an interesting aspect of this experiment is that it shows a little of the non-local nature of quantum mechanics, by getting knowledge of whether a ``bomb" (perfect absorber) is in one of the arms of the interferometer by measuring a photon that did not interact with the ``bomb" (if it did it would be absorbed). The bomb is supposed to explode if a single photon interacts with it, Elitzur and Vaidman proposed to have a mechanism such that one could detect if the bomb was there or not, without it exploding. Our calculations will show that this can be achieved about $50\%$ of the time at most.


\begin{figure}[h!]
\centering
\includegraphics[width=\linewidth]{images/machzenhderbomb.png}
\caption{Elitzur-Vaidman's bomb detector}
\label{fig:BS2}
\end{figure}

To analyze this case we will simply repeat the calculations we did above this time having a perfect absorber in the vertical arm of the interferometer as Fig. 2 shows. We also need to consider that once the photon is absorbed the optical elements do not interact with it anymore. We will denote an absorbed photon using the $\ket{abs}$ state. First, the initial state is transformed by the first $BS$ then the vertical path is absorbed by our perfect absorber then the state encounters mirrors and then if finally recombined in the second $BS$
 
\begin{align*}
&\ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2}\\ &\xrightarrow{\text{Bomb}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{abs}\\ &\xrightarrow{\text{Mirrors}}
 i\cos(\theta_{1})\ket{2}+i\sin(\theta_{1})\ket{abs} \\ &\xrightarrow{\text{BS2}}i\cos(\theta_{1})\cos(\theta_{2})\ket{2}-\cos(\theta_{1})\sin(\theta_{2})\ket{1}+i\sin(\theta_{1})\ket{abs}. \numberthis
\end{align*}

The probabilities to be absorbed or detected at either $D_{1}$ or $D_{2}$ are given by :

\begin{align}
P_{D_{1}}&=\cos^2(\theta_{1}) \sin^2(\theta_{2}),\\
P_{D_{2}}&=\cos^2(\theta_{1}) \cos^2(\theta_{2}),\\
P_{abs}&=\sin^2(\theta_{1}).
\end{align}

Let us again consider the case where $\theta_{1}=\theta_{2}=\frac{\pi}{4}$ then:

\begin{equation}
P_{D_{1}}=\frac{1}{4},\quad P_{D_{2}}=\frac{1}{4}, \quad P_{abs}=\frac{1}{2}.
\end{equation}



Since we are dealing with just one measurement it is not so useful to talk about conditional probabilities such as, what is the probability of detecting in $D_{2}$, if the object isn't absorbed in the same way that it is not useful to talk about the probability of having a single dice throw come out as six provided it was not one. However it is useful to talk about the efficiency of this interferometers, that is just how probable is it for us to realize interaction free measurements, the efficiency is given by \cite{5}:

\begin{equation}
\eta=\frac{P_{det}}{P_{det}+P_{abs}},
\end{equation}

where $\eta$ is the efficiency, $P_{det}$ is the probability the object is detected and $P_{abs}$ is the probability that the object is absorbed, considering lossless devices, which we do in this work $P_{det}+P_{abs}=1$ and we have

\begin{equation}
\eta=P_{D_{1}}+P_{D_{2}}.
\end{equation}

So for example in the case we explored in this section $\eta=\frac{1}{2}$ so fifty percent of the time we have interaction-free measurements , to tell wheter an object is there or not we need to consider that if the photon is detected at $D_{2}$ it would indicate that there's an object in one of the arms of the interferometer. However, we cannot distinguish between this case and the previous one from a single event if we detect at $D_{1}$, so $\frac{1}{2}$ of the times we make a measurement we can't tell if a bomb is there or not.

\section{The single-photon Mach-Zehnder interferometer with an  imperfect transmitter}

This section and the next ones are based on the treatment done by Z.Blanco and O.Rosas-Ortiz \cite{zuri,azuri} and the work done by Azuma \cite{Azuma}. Let us consider an object such that $\alpha'$ and $\beta'$ are its absorption and transmission coefficients, respectively, satisfying the condition $|\alpha|^2 + |\beta|^2 = 1.$.

We will use the same Horizontal-Vertical basis and our initial state $\ket{1}$. We will place our imperfect absorber in the vertical path. Our absorber can either transmit with probability $|\beta|^2$ or absorb with probability $|\alpha|^2$, such that when encountered with this object our states become:


\begin{align}
\ket{2}\xrightarrow[\text{Absorber}]{\text{Imperfect}}\alpha \ket{abs} +\beta \ket{2}.
\end{align}

With this information we can now go on with our calculations, First, the initial state goes through a $BS$, then it encounters our imperfect transmitter, after that it goes through a mirror in each path and then it is finally recombined in the second $BS$:

\begin{align*}
& \ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2} \\ &\xrightarrow[\text{Absorber}]{\text{Imperfect }}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})(\alpha \ket{abs} +\beta \ket{2} )
\\ &\xrightarrow{\text{Mirrors}} i\cos(\theta_{1})\ket{2}+i \sin(\theta_{1})\alpha\ket{abs}-\sin(\theta_{1})\beta\ket{1} \\ &\xrightarrow{\text{BS2}} -
(\cos(\theta_{1})\sin(\theta_{2})+\beta \sin(\theta_{1})\cos(\theta_{2}))\ket{1}+ i \alpha \sin(\theta_{1})\ket{abs} \\ &+i(\cos(\theta_{1})\cos(\theta_{2})-\sin(\theta_{1})\sin(\theta_{2})\beta)\ket{2}. \numberthis
\end{align*}


We will write detection probabilities as $P_{ij}$ where $i=1,2$ the path of the interferometer where the imperfect transmitter is placed, and $j$ is one of the possible outcomes, therefore the detection probabilities are given by:

\begin{align}
& P_{2D_{1}}=|\cos(\theta_{1})\sin(\theta_{2})+\beta \sin(\theta_{1})\cos(\theta_{2})|^2, \\
& P_{2D_{2}}=|\cos(\theta_{1})\cos(\theta_{2})-\beta \sin(\theta_{1})\sin(\theta_{2})|^2, \\
& P_{2abs}=|\alpha \sin(\theta_{1})|^2.
\end{align}

If we consider the same procedure but this time we put our imperfect absorber on the horizontal arm of the interferometer we obtain:

\begin{align}
P_{1D_{1}}&=|\cos(\theta_{1})\sin(\theta_{2})\beta +\sin(\theta_{1})\cos(\theta_{2})|^2, \\
P_{1D_{2}}&=|\sin(\theta_{1})\sin(\theta_{2})-\beta \cos(\theta_{1})\cos(\theta_{2})|^2,\\
P_{1abs}&=|\alpha \cos(\theta_{1})|^2.
\end{align}



Observing the probabilities are different we can obtain the difference between them, expressions concerning the difference between $PD_{1}$ and $PD_{2}$ are important because they tell us just how distinguishable these outcomes are:


\begin{align}
P_{1D_{1}}-P_{2D_{1}}=(1-|\beta|^2)\left(\frac{\cos(2 \theta_{1})-\cos(2 \theta_{2})}{2}\right), \\
P_{1D_{2}}-P_{2D_{2}}=(1-|\beta|^2)\left(\frac{\cos(2 \theta_{1})+\cos(2 \theta_{2})}{2}\right).
\end{align}

From there, we can say that the probabilities are the same only when :

a)$\beta=1  $ which means a transparent object.

b)$\cos(2 \theta_{2})+\cos(2\theta_{1})=\cos(2 \theta_{1})-\cos(2\theta_{2})=0$   which means   $\theta_{1}=\theta_{2}=\frac{\pi}{4}\pm 2n\pi$
.

We can also obtain an expression for one of the angles in terms of the probabilities


\begin{align}
\theta_{2}=\frac{\cos^{-1}[\frac{(P_{1D_{2}}-P_{2D_{2}})-(P_{1D_{1}}-P_{2D_{1}})}{1-|\beta|^2}]}{2},\\
\theta_{1}=\frac{\cos^{-1}[\frac{(P_{1D_{2}}-P_{2D_{2}})+(P_{1D_{1}}-P_{1D_{1}})}{1-|\beta|^2}]}{2}.
\end{align}


\pagebreak

\blankpage{}

\chapter[BS as imperfect transmitter]{Beam splitter as imperfect \\ trasmitter}

We will now study the case of a $BS$ as an imperfect transmitter. We consider imperfect mirrors such that $\gamma \neq 0$. We will see this is equivalent to including phase shifters in section 3.2 like in the previous cases we will first consider our imperfect transmitter in the vertical path as the Fig. \ref{bs vertical} shows, as we can see from the figure the reflected photon goes out of the interferometer's paths and therefore it is lost instead of being absorbed.

\begin{figure}[h!]
\centering
\includegraphics[width=\linewidth,height=7.5 cm]{images/machzenhderbs.png}
\caption{Mach-Zehnder interferometer with a $BS$ as imperfect transmitter}
\label{bs vertical}
\end{figure}

Our imperfect transmitter is a $BS$ whose transmission coefficient is $\cos(\theta_{o})$ and its reflection coefficient is $i\sin(\theta_{o})$. When a state interacts with our imperfect transmitter it becomes:

\begin{align}
\ket{2}\xrightarrow[\text{Absorber}]{\text{Imperfect}}i\sin(\theta_{o}) \ket{abs} +\cos(\theta_{o}) \ket{2}.
\end{align}

We consider the reflected photon to be lost since it goes out of our interferometer, and we denote that ``lost photon'' state by $\ket{abs}$, with that in mind now we can begin our calculation which is analogous to the ones from the previous sections:


\begin{align*}
&\ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2}\\
&\xrightarrow{\text{BS}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})(\cos(\theta_{o})\ket{2}+i\sin(\theta_{o})\ket{abs})\\ &\xrightarrow{\text{Mirrors}} \cos(\theta_{1})e^{i\gamma_{1}}\ket{2}+i\sin(\theta_{1})\cos(\theta_{o})e^{i\gamma_{2}}\ket{1}-\sin(\theta_{1})\sin(\theta_{o})\ket{abs}\\ &\xrightarrow{\text{BS2}}\cos(\theta_{1})e^{i\gamma_{1}}(\cos(\theta_{2})\ket{2}
+i\sin(\theta_{2})\ket{1})+i\sin(\theta_{1})\cos(\theta_{o})e^{i\gamma_{2}}\\
&\times (\cos(\theta_{2})\ket{1}+i\sin(\theta_{2})\ket{2})-\sin(\theta_{1})\sin(\theta_{o})\ket{abs}\\
&=(\cos(\theta_{1})e^{i\gamma_{1}}\cos(\theta_{2})-\sin(\theta_{1})\sin(\theta_{2})\cos(\theta_{o})e^{i\gamma_{2}})\ket{2}-\sin(\theta_{1})\sin(\theta_{o})\ket{abs}\\ &+(i\cos(\theta_{1})\sin(\theta_{2})e^{i\gamma_{1}}+
 i \sin(\theta_{1})\cos(\theta_{o})\cos(\theta_{2})e^{i\gamma_{2}})\ket{1}.\numberthis
\end{align*}



Detection probabilities are shown in Fig. \ref{P_bs}, where we can see that for certain values of $\theta_{i}$ where $i=1,2,o$ the probabilities of detection in $D_{2}$ can be close to one:


\begin{figure}[t!]
\centering
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=2.8 cm]{images/P1abs.png}
\caption{$P_{2abs}$}
\label{fig:BS2}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=2.8 cm]{images/P1d1.png}
\caption{$P_{2D_{1}}$}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=2.8 cm]{images/P1d2.png}
\caption{$P_{2D_{2}}$}
\label{fig:BS2}
\end{subfigure}
\caption{Probability distributions with imperfect absorber in vertical path and $\theta_{o}=\frac{\pi}{3}$ y $\gamma_{2}-\gamma_{1}=\pi$.}
\label{P_bs}
\end{figure}


\begin{align}
 P_{2D_{1}}&=|ie^{i\gamma_{1}}\cos(\theta_{1})\sin(\theta_{2})+i e^{i\gamma_{2}}\cos(\theta_{o}) \sin(\theta_{1})\cos(\theta_{2})|^2,\\
 P_{2D_{2}}&=|\cos(\theta_{1})\cos(\theta_{2})e^{i\gamma_{1}}- e^{i\gamma_{2}}\cos(\theta_{o}) \sin(\theta_{1})\sin(\theta_{2})|^2,\\
 P_{2abs}&=|\sin(\theta_{o}) \sin(\theta_{1})|^2.
\end{align}


Repeating the same calculation with the object in the horizontal path we obtain the following probabilities, which are shown graphically in Fig. \ref{P_bs2}. We can see they are quite different and that is because we are always launching our photon from the same path, therefore, the situation is not symmetrical, that is the object isn't always in the same path the photon was sent into:


\begin{figure}[t!]
\centering
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/P11abs.png}
\caption{$P_{1abs}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth ,height=3 cm]{images/P11d1.png}
\caption{$P_{1D_{1}}$}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/P11d2.png}
\caption{$P_{1D_{1}}$}
\label{fig:BS1}
\end{subfigure}
\caption{Probabilities distribution in the Horizontal path for $\theta_{o}=\frac{\pi}{3}$ y $\gamma_{2}-\gamma_{1}=\pi$}
\label{P_bs2}
\end{figure}



\begin{align}
P_{1D_{1}}&=|ie^{i\gamma_{1}}\cos(\theta_{1})\sin(\theta_{2})\cos(\theta_{o})+i e^{i\gamma_{2}}\sin(\theta_{1})\cos(\theta_{2})|^2, \\
P_{1D_{2}}&=|\cos(\theta_{1})\cos(\theta_{o})\cos(\theta_{2})e^{i\gamma_{1}}-e^{i\gamma_{2}} \sin(\theta_{1})\sin(\theta_{2})|^2,\\
P_{1abs}&=|\sin(\theta_{o}) \cos(\theta_{1})|^2.
\end{align}


This analysis is totally consistent with Zurika's \cite{zuri} when one takes the case $\beta'=\cos(\theta_{o})$, $\alpha'=i \sin(\theta_{o})$ and $\gamma_{2}-\gamma_{1}=0$. However this case has a little advantage and that is that our ``absorbed'' photon, is not absorbed but goes out of our interferometer so we can measure all outputs of the interferometer by placing a detector, say $D_{abs}$, in the path the ``lost photon" would follow.

\section{$N$ Beam Splitters as imperfect transmitter }


\begin{figure}[H]
\centering
\includegraphics[width=\linewidth,height=8 cm]{images/machzenhderBSS.png}
\caption{Mach-Zehnder with $N$ $BS$ as imperfect transmitter}
\label{N_bs}
\end{figure}


We begin analyzing what happens if our initial state goes through several $BS$ assuming the reflected photon is ``lost". We will study both initial states in parallel, as Fig. \ref{N_bs} shows. We are placing $N$ beams splitters in one of the paths of the interferometer so:

\begin{align}
BS_{3}\ket{2}=\cos(\theta_{3})\ket{2}+i\sin(\theta_{3})\ket{abs}.
\end{align}

The next $BS$ only acts on the transmitted photon so:
\begin{align}
BS_{4}(\cos(\theta_{3})\ket{3}+i\sin(\theta_{3})\ket{abs})&=\cos(\theta_{1})BS_{2}\ket{2}+i\sin(\theta_{3})\ket{abs},\\
BS_{4}BS_{3}\ket{1}&=\cos(\theta_{3})\cos(\theta_{4})\ket{1}+i A\ket{abs}.
\end{align}
where $A$ is whatever the absorption coefficient for two $BS$ may be. Then, the next $BS$ does the same
\begin{equation}
BS_{5}BS_{4}BS_{3}\ket{2}=\cos(\theta_{3})\cos(\theta_{4})\cos(\theta_{5})\ket{2}+iB\ket{abs}.
\end{equation}

so after $n$ $BS$ :

\begin{align*}
BS^{n}=BS_{n}...BS_{3}\ket{2}=\cos(\theta_{3})\cos(\theta_{4})\cos(\theta_{5})....\cos(\theta_{n})\ket{2} +i C\ket{abs}. \numberthis
\end{align*}

We can obtain $C$ by asking the probabilities to add to unity, since everything that is not transmitted will be ``lost":

\begin{align}
BS^{n}\ket{2}&=\prod_{i=3}^{n} \cos(\theta_{i})\ket{2}+i C \ket{abs},\\
C&=\sqrt{1-\prod_{i=3}^{n}\cos^2(\theta_{i})}.
\end{align}

Following the same procedure we could obtain the same result if the object was in the other arm of the interferometer. We now use this as a imperfect absorber in the vertical path:

\begin{align*}
&\ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2}\\ &\xrightarrow{{B^{n}}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\prod_{i=3}^{n} \cos(\theta_{i})\ket{2}-\sin(\theta_{1})\sqrt{1-\prod_{i=3}^{n}\cos^2(\theta_{i})}\ket{abs} \\ & \xrightarrow{{Mirrors}}\cos(\theta_{1})  e^{i \gamma_{1}}\ket{2}+i\sin(\theta_{1})\prod_{i=3}^{n} \cos(\theta_{i}) e^{i \gamma_{2}}\ket{1}\\
&-\sin(\theta_{1})\sqrt{1-\prod_{i=3}^{n}\cos^2(\theta_{i})}\ket{abs} \\ & \xrightarrow{{BS2}}(\cos(\theta_{1})\cos(\theta_{2})e^{i \gamma_{1}}-\sin(\theta_{1})\sin(\theta_{2})e^{i \gamma_{2}}\prod_{i=3}^{n} \cos(\theta_{i}))\ket{2}\\ &+ i(\cos(\theta_{1})\sin(\theta_{2})e^{i \gamma_{1}}+\cos(\theta_{2})\sin(\theta_{1})e^{i \gamma_{2}}\prod_{i=3}^{n} \cos(\theta_{i}))\ket{1}\\ &-\sin(\theta_{1})\sqrt{1-\prod_{i=3}^{n}\cos^2(\theta_{i})}\ket{abs}.
\end{align*}
 
The probabilities of detection in each of the detectors are given by:

\begin{align}
P_{D_{1}}&=|\cos(\theta_{1})\sin(\theta_{2})e^{i \gamma_{1}}+\cos(\theta_{2})\sin(\theta_{1})e^{i \gamma_{2}}\prod_{i=3}^{n} \cos(\theta_{i})|^2,\\
P_{D_{2}}&=|\cos(\theta_{1})\cos(\theta_{2})e^{i \gamma_{1}}-\sin(\theta_{1})\sin(\theta_{2})e^{i \gamma_{2}}\prod_{i=3}^{n} \cos(\theta_{i})|^2,\\
P_{abs}&=\sin^2(\theta_{1})\left(1-\prod_{i=3}^{n}\cos^2(\theta_{i})\right).
\end{align}

\subsection{Analysis with phase retarders }

The interferometer is an instrument quite hard to align experimentally, in most cases alignment is a little off. We can characterize just how off this alignment is by considering the effects of phase retarders on the interferometer after all misalignment is nothing but differences in the optical path. Those predictions can be compared with the actual interferometer (without phase retarders), a wave retarder's  matrix representation is \footnote{When placed in the horizontal path $k=0$ and when placed in the vertical $c=0$}:


\begin{equation}
 Retarder=\begin
{pmatrix} e^
{i c} & 0\\0& e^
{i k }\end
{pmatrix}.
\end{equation}

Let us see the effect of such an optical device in our setup:
\begin{align*}
&\ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2}\\ &\xrightarrow[\text{absorber}]{\text{Imperfect }}cos(\theta_{1})\ket{1}+i\sin(\theta_{1})(\alpha' \ket{abs} +\beta' \ket{2} )\\& \xrightarrow[\text{Retarders}]{\text{Phase}}\cos(\theta_{1})e^{ic}\ket{1}+i\beta'\sin(\theta_{1}) e^{ik}\ket{2} +i\alpha'\sin(\theta_{1}) \ket{abs}\\ &\xrightarrow{\text{Mirrors}} \cos(\theta_{1})e^{i(\gamma_{1}'+c)}\ket{2}+i \sin(\theta_{1})\alpha'\ket{abs}+i\sin(\theta_{1})\beta'e^{i(\gamma_{2}'+k)}\ket{1},
\end{align*}

we can stop here by noticing that making $\gamma_{2}'+k=\gamma_{2}$ and $\gamma_{1}'+c=\gamma_{1}$ we have the exact same case as in our previous sections, like in the section of a $BS$ as an imperfect absorber with  $\beta=cos(\theta_{o})$ and $\alpha=i\sin(\theta_{o})$ so our model that makes use of the general matrix of a mirror instead of using the more popular perfect mirror matrix $M=\begin{pmatrix} i & 0\\0& i\end{pmatrix}$, where $i=e^{i \frac{\pi}{2}}=\gamma$, has the  effect of a phase retarder included, allowing us to study misalignment.



\pagebreak

\chapter{A Time-dependent transmitter}

In this chapter we will analyze the case of an object whose transmission and absorption coefficients depend on time, we will explore the case of an optical chopper whose time dependence is discrete. Since what we measure in the lab are probability distributions and those that change in time are quite difficult to visualize in a paper, the reader can see the behavior better in \href{https://github.com/mcditoos/Single-Photon-Mach-Zehnder-}{a Mathematica notebook}. Let us begin by analyzing the optical chopper as a perfect absorber.

\section{Optical chopper as perfect absorber }
 
 \begin{figure}[h!]
\centering
\includegraphics[width=\linewidth]{images/machzenhderchopper.png}
\caption{Mach-Zehnder with an optical chopper as an imperfect absorber}
\label{chopper}
\end{figure}
An optical chopper is a device that periodically interrupts light. It is usually a disk with holes rotating with a certain frequency (which can vary in time) from its definition we can infer that it can be modeled using a square wave which can be written as  $f(t)=\frac{sgn(\sin(wt))+1}{2}$, where $\omega$ is the angular frequency of the optical chopper multiplied by the number of ``hole-material" pairs which for now we assume are the same size.
 
We will be ignoring diffraction effects, a consequence of modeling it like this is that consecutive optical choppers become the product of square waves and products of square waves is again a square wave, so modeling many choppers would be the same as modeling one with that effective frequency. In this section we intend to analyze the Mach-Zehnder interferometer with a chopper being the imperfect absorber as Fig. \ref{chopper}, the chopper introduces a discrete-time dependence, therefore we will be alternating between two different probability distributions.


We can model our optical chopper by using an operator $C_{i}$ where $i$ is the path where the chopper is placed, such that in our base(where $i=1,2$ and $i \neq j$):

\begin{align}
C_{i}\ket{i}&=f(t)\ket{i},\\
C_{j}\ket{i}&=\ket{i}.
\end{align}

Ideally, we want this operator to be unitary in the ``hole" cycle. Since we are modeling the whole as a transparent object. This will be checked right away:

\begin{equation}
|f|^2=\frac{(sgn(\sin(wt)+1)^2}{4},
\end{equation}
the sign function squared is always one so
\begin{align}
&|f|^2=\frac{2(1+sgn(\sin(wt)))}{4}, \\
&|f|^2=f,
\end{align}


from there we can see that it is a unitary matrix whenever the sine is in the positive cycle, and it becomes null in the negative cycle, that happens because in the negative cycle we have total absorption. The absorption coefficient would  be:  

\begin{align}
 a&=1-f,\\
 a&=\frac{1-sgn(\sin(wt))}{2},\\
|a|^2&=\frac{2(1-sgn(\sin(wt)))}{4},\\
|a|^2&=a.
\end{align}

We will now analyze a Mach-Zehnder interferometer using a chopper as a time-dependent absorber. The chopper will be placed on the vertical path, and our photon will go into the interferometer using the horizontal path



\begin{align*}
&\ket{1}\xrightarrow{\text{BS1}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})\ket{2}\\ &\xrightarrow{\text{Chopper}}\cos(\theta_{1})\ket{1}+i\sin(\theta_{1})f\ket{2}+i\sin(\theta_{1})a\ket{abs}\\ &\xrightarrow{\text{Mirrors}} \cos(\theta_{1})e^{i\gamma_{1}}\ket{2}+i\sin(\theta_{1})f e^{i\gamma_{2}}\ket{1}+i\sin(\theta_{1})a\ket{abs}\\& \xrightarrow{\text{BS2}}\cos(\theta_{1})e^{i\gamma_{1}}(\cos(\theta_{2})\ket{2}\\
&+i\sin(\theta_{2})\ket{1})+i\sin(\theta_{1})e^{i\gamma_{2}}f(\cos(\theta_{2})\ket{1}+i\sin(\theta_{2})\ket{2})+i\sin(\theta_{1})a\ket{abs}\\
& = i(e^{i\gamma_{1}}\cos(\theta_{1})\sin(\theta_{2})+f e^{i\gamma_{2}}\sin(\theta_{1})\cos(\theta_{2}))\ket{1}+(\cos(\theta_{1})\cos(\theta_{2}) e^{i\gamma_{1}} \\&  -\sin(\theta_{1})\sin(\theta_{2})f e^{i \gamma_{2}})\ket{2}+i\sin(\theta_{1})a\ket{abs}. \numberthis
\end{align*}



A plot for the detection probabilities is shown in Fig. \ref{Pchopper}, as we mentioned before the system is alternating between two probability distributions. We can see those for each of the possible states in the figure. It is worth noting that the absorption graph alternates between the one shown and no absorption:



\begin{figure}[t!]
\centering

\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc2Abs.png}
\caption{$P_{1abs}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,,height=3 cm]{images/Pc2D21.png}
\caption{$P_{2D_{2}}$ in the first cycle }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc2D22.png}
\caption{$P_{2D_{2}}$ in the second cycle}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc2D11.png}
\caption{$P_{2D_{1}} $ in the first cycle}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc2D12.png}
\caption{$P_{2D_{1}} $ in the second cycle }
\label{fig:BS1}
\end{subfigure}
\caption{Probability Distribution for $\gamma_{2}-\gamma_{1}=\frac{\pi}{2}$ in the vertical path}
\label{Pchopper}
\end{figure}


\begin{align}
&P_{2D_{1}}=|e^{i\gamma_{1}}\cos(\theta_{1})\sin(\theta_{2})+f e^{i\gamma_{2}}\sin(\theta_{1})\cos(\theta_{2})|^2,\\
&P_{2D_{2}}=|\cos(\theta_{1})\cos(\theta_{2})e^{i\gamma_{1}}- f \sin(\theta_{1})\sin(\theta_{2})e^{i\gamma_{2}}|^2,\\
&P_{2abs}=|a \sin(\theta_{1})|^2.
\end{align}

Which can be rewritten as:
\begin{align*}
& P_{2D_{1}}=\cos^2(\theta_{1})\sin^2(\theta_{2})+f^2 \sin^2(\theta_{1})\cos^2(\theta_{2})+\\
&\frac{f \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2}, \numberthis{}\\
& P_{2D_{2}}=\cos^2(\theta_{1})\cos^2(\theta_{2})+ f^2 \sin^2(\theta_{1})\sin^2(\theta_{2})-\\
&\frac{f \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{} \\
& P_{2abs}=a^2 \sin^2(\theta_{1}).\numberthis{}
\end{align*}

By the same procedure having the chopper in the horizontal path, one can obtain the following results which are shown in Fig. \ref{P2chopper}, for each of the possible states of the system
 
\begin{figure}[h!]
\centering
\begin{subfigure}[b]{0.35\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc1Abs.png}
\caption{$P_{1abs}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.35\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc1D21.png}
\caption{$P_{1D_{2}}$ in the first cycle }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.35\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc1D22.png}
\caption{$P_{1D_{2}}$ in the second cycle}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.35\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc1D11.png}
\caption{$P_{1D_{1}} $ in the first cycle}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.35\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/Pc1D12.png}
\caption{$P_{1D_{1}} $in the second cycle }
\label{fig:BS1}
\end{subfigure}
\caption{Probability distribution for the horizontal path and  $\gamma_{2}-\gamma_{1}=\frac{\pi}{2}$}
\label{P2chopper}
\end{figure}

\begin{align*}
& P_{1D_{1}}=\cos^2(\theta_{1})\sin^2(\theta_{2})f^2+ \sin^2(\theta_{1})\cos^2(\theta_{2})+\\
&\frac{f \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{}\\
& P_{1D_{2}}=\cos^2(\theta_{1})\cos^2(\theta_{2})f^2+ \sin^2(\theta_{1})\sin^2(\theta_{2})-\\
&\frac{f \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{}\\
& P_{1abs}=a^2 \cos^2(\theta_{1}). \numberthis{}
\end{align*}

Since $f^2=f$, we can write the difference of probabilities as:

\begin{align}
P_{1D_{1}}-P_{1D_{2}}=(a)\left(\frac{\cos(2 \theta_{1})-\cos(2 \theta_{2})}{2}\right),\
P_{1D_{2}}-P_{2D_{2}}=(a)\left(\frac{\cos(2 \theta_{1})+\cos(2 \theta_{2})}{2}\right).
\end{align}
 From there we can obtain either $\theta_{1}$  or $\theta_{2}$ :
\begin{align}
&(P_{1D_{1}}-P_{1D_{2}})+(P_{1D_{2}}-P_{2D_{2}})=(a)(\cos(2 \theta_{1})),\\
&(P_{1D_{1}}-P_{1D_{2}})-(P_{2D_{1}}-P_{2D_{2}})=(-a)(\cos(2 \theta_{2})).,\
 &\theta_{1}=\frac{1}{2}\cos^{-1}\left[\frac{(P_{1D_{1}}-P_{2D_{1}})+(P_{1D_{2}}-P_{2D_{2}})}{a}\right],\\
 &\theta_{2}=\frac{1}{2}\cos^{-1}\left[\frac{(P_{1D_{1}}-P_{2D_{1}})-(P_{1D_{2}}-P_{2D_{2}})}{a}\right].
 \end{align}
 
\pagebreak

\section{Optical chopper as imperfect absorber}

Previously we considered the ``material" part of the chopper as a perfect absorber. In this section we will now generalize to when it is an imperfect absorber, this can be done quite simply by defining :
 

\begin{align}
f_{hole}&=\frac{1+sgn(\sin(wt))}{2},\\
f_{material}&=\left(\frac{1-sgn(\sin(wt))}{2} \right)\beta,\\
f&=f_{material}+f_{hole},
\end{align}


where $\beta$ is the transmission coefficient of the material part of our chopper, $\beta$ could be a function of  $\omega$ or $t$ in this analysis. The operator used to describe our chopper is the same as in the previous section, we define:

\vspace{0.5cm}
\begin{equation}
a=\left(\frac{1-sgn(\sin(wt))}{2}\right) \alpha,
\end{equation}
\vspace{0.5cm}

where $\alpha$ is the absorption coefficient of the material part of our chopper, by using this notation we have the same case as in the previous section, except this time $f^2 \neq 1$ :

\begin{align}
|a|^2&=a \alpha.\\
|f_{material}|^2&=f_{material} \beta,
\end{align}

which we can generalize to obtain:

\begin{align}
|a|^n&=a\alpha^{n-1},\\
|f_{material}|^n&=f_{material} \beta^{n-1},
\end{align}
so we have:

\begin{equation}
|f|^2=  \frac{\abs{\alpha}^2}{2} sgn(\sin(wt)) +\frac{1+\abs{\beta}^2}{2}.
\end{equation}



Substituting in the previous section yields the probability distributions shown in Fig. \ref{P3chopper}:

\begin{figure}[h]
\centering
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/p1cabs.png}
\caption{$P_{1abs}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/p1cd21.png}
\caption{$P_{1D_{2}}$ in the first cycle }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/p1cd22.png}
\caption{$P_{1D_{2}}$ in the second cycle}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/p1cd11.png}
\caption{$P_{1D_{1}} $ in the first cycle}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/p1cd12.png}
\caption{$P_{1D_{1}} $ in the second cycle }
\label{fig:BS1}
\end{subfigure}
\caption{Probability Distribution in the horizontal path with  $\gamma_{2}-\gamma_{1}=0 $ y $\beta=0.5$}
\label{P3chopper}
\end{figure}


\begin{align*}
&P_{1D_{1}}=\cos^2(\theta_{1})\sin^2(\theta_{2})\abs{f}^2+ \sin^2(\theta_{1})\cos^2(\theta_{2})\\
&+\frac{\Re{f} \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{}\\
&P_{1D_{2}}=\cos^2(\theta_{1})\cos^2(\theta_{2})\abs{f}^2+ \sin^2(\theta_{1})\sin^2(\theta_{2})\\
&-\frac{\Re{f} \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{}\\
&P_{1abs}=\abs{\alpha}^2 \cos^2(\theta_{1}).\numberthis{}
\end{align*}


When the optical chopper is in the vertical path we obtain the following detection probabilities. The probability distributions are shown in Fig. \ref{P4chopper}:

\begin{figure}[!h]
\centering
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/pcabs.png}
\caption{$P_{2abs}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/pcd21.png}
\caption{$P_{2D_{1}}$ in the first cycle }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/pcd22.png}
\caption{$P_{2D_{1}}$ in the second cycle}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/pcd11.png}
\caption{$P_{2D_{1}} $ in the first cycle}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth,height=3 cm]{images/pcd12.png}
\caption{$P_{2D_{1}} $ in the second cycle }
\label{fig:BS1}
\end{subfigure}
\caption{Probability Distribution for the vertical path with  $\gamma_{2}-\gamma_{1}=0 $ y $\beta=0.5$}
\label{P4chopper}
\end{figure}

\begin{align*}
&P_{2D_{1}}=\cos^2(\theta_{1})\sin^2(\theta_{2})+\abs{f}^2 \sin^2(\theta_{1})\cos^2(\theta_{2})\\
&+\frac{\Re{f} \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{}\\
&P_{2D_{2}}=\cos^2(\theta_{1})\cos^2(\theta_{2})+ \abs{f}^2 \sin^2(\theta_{1})\sin^2(\theta_{2})\\
&-\frac{\Re{f} \sin(2\theta_{1})\sin(2\theta_{2})\cos(\gamma_{1}-\gamma_{2})}{2},\numberthis{}\\
&P_{2abs}=\abs{\alpha}^2 \sin^2(\theta_{1}).\numberthis{}
\end{align*}



\newpage


\chapter{Analysis of $N$ interferometers }
 
 The notation previously used is not popular when dealing with nested interferometers. To be consistent with the existing literature we will use the same notation as Kwait et al.\cite{5}, where we have an interferometer  like the one in the following Fig. \ref{Nmach}, we see from the figure that we will have $N$ $BS$ and $N-1$ Absorbers:
 
\begin{figure}[!htb]
\centering
\includegraphics[width=\linewidth]{images/nmach.png}
\caption{Nested Mach-Zehnders  with imperfect absorbers}
\label{Nmach}
\end{figure}
 
 We will still use a binary basis, but instead of using the Horizontal-Vertical, it will be a path A-path B basis. That is an ``up-down" basis, we will use $\ket{2}$ for path $b$ and $\ket{1}$ for path $a$, one of the main advantages of this basis is that the mirror matrices are diagonal because they keep our photon on the same path. We will model our imperfect absorber using a non-unitary diagonal matrix just as was done by  Azuma \cite{Azuma}.   
 
 Azuma used a matrix of the form, where $n=\abs{\beta}^{2}$:
 
 \begin{equation}
 A_{Azuma}=\begin{pmatrix} \sqrt{n} & 0\\0& 1\end{pmatrix}.
\label{absorber}
 \end{equation}

Since we are using a $BS$ as an imperfect absorber a more suitable option would be :
\begin{equation}
 A_{BS}=\begin{pmatrix} \cos(\theta) & 0\\0& 1\end{pmatrix}.
\label{absorber1}
\end{equation}

The final state can be obtained by applying all of the operators to the initial state which will be $\ket{2}$, Let us first consider that we have no imperfect absorbers on the interferometer, then the only operators acting on the state are $BS$ then:

\begin{align}
BS_{i} \times BS_{i+1}&=\begin{pmatrix} \cos(\theta_{i}) & i \sin(\theta_{i}) \\ i \sin(\theta_{i}) & \cos(\theta_{i}) \end{pmatrix}  
\begin{pmatrix} \cos(\theta_{i+1}) & i \sin(\theta_{i+1}) \\ i \sin(\theta_{i+1}) & \cos(\theta_{i+1}) \end{pmatrix},\\
&=\begin{pmatrix} \cos(\theta_{i}+\theta_{i+1}) & i \sin(\theta_{i}+\theta_{i+1}) \\ i \sin(\theta_{i}+\theta_{i+1}) & \cos(\theta_{i}+\theta_{i+1}) \end{pmatrix}.
\end{align}

if we assume $N$ $BS$ that are identical:

\begin{equation}
BS^{N}=\begin{pmatrix} \cos(N\theta) & i \sin(N\theta) \\ i \sin(N\theta) & \cos(N\theta) \end{pmatrix},
\end{equation}

Let us assume $\theta=\frac{\pi}{2N}$ so we have:

\begin{equation}
BS^{N}=\begin{pmatrix} 0 & i  \\ i  & 0 \end{pmatrix},
\end{equation}

so we will always detect the photon in the path that is not the one we sent our photon in, with this in mind let us see what happens with this particular $\theta$ when we do have imperfect absorbers. The state first goes through a $BS$, then one of the imperfect absorbers and then another $BS$, it keeps going like that until it encounters the $Nth$ and last $BS$. We have $N$ $BS$ and $N-1$ imperfect absorbers so our final state is:


\begin{equation}\ket{2}\xrightarrow[\text{interferometers}]{\text{Nested}}(B \times A)^{N-1}B \ket{2}.
\end{equation}

Detection probabilities are given by:

\begin{align}
&P_{D_{1}}=|\bra{2} (B \times A)^{N-1}B \ket{2}|^2,\\
&P_{D_{2}}=|\bra{1} (B \times A)^{N-1}B \ket{2}|^2,\\
&P_{abs}=1-P_{D_{1}}-P_{D_{2}}.
\end{align}
 
 
To obtain said probabilities as well as the behavior of the system for varying $N$ we will make use of a computer. The program was written in python and yielded the following results:


 
\begin{figure}[h]
\centering
\begin{subfigure}[b]{0.3\linewidth}
\includegraphics[width=\linewidth,height=5 cm]{images/BS_Azuna.png}
\caption{$P_{D_{1}}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.3\linewidth}
\includegraphics[width=\linewidth,height=5 cm]{images/BS_AzunaD2.png}
\caption{$P_{D_{2}}$}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.3\linewidth}
\includegraphics[width=\linewidth,height=5 cm]{images/absorbido_azuna.png}
\caption{$P_{abs}$}
\label{fig:BS1}
\end{subfigure}
\caption{Probabilities when $BS$ is an imperfect absorber, $D_{1}$ is in path b, and $D_{2}$ in path a}
\label{Azuma1}
\end{figure}


Fig. \ref{Azuma1} shows the different probabilities for absorption, and detection as we increase $N$. We can see this asymptotically approaches 1 as Azuma had shown \cite{Azuma}, the case of a $BS$ as an absorber shows consistency. This is important because the case of a $BS$ is described by the same mathematics that and analyzer and a polarizer \cite{leonhardt_2003} and unlike other absorbers this can be manipulated continually, giving us a way to test this curves experimentally.
 
One may wonder how the system behaves for growing $N$ with the same kind of $BS$ for all $N$, maybe we could make the probabilities grow as well, but after the analysis. We can see that even though it grows for low $N$ it soon begins to lower and approaches zero very quickly for most values as we can see below.


\begin{figure}[!htb]
\centering
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/BsFijo_azumaD1.png}
\caption{$P_{D_{1}}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/BsFijo_azumaD2.png}
\caption{$P_{D_{2}}$}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.45\linewidth}
\includegraphics[width=\linewidth]{images/BsFijo_azumaabs.png}
\caption{$P_{D_{2}}$}
\label{fig:BS1}
\end{subfigure}
\caption{Behavior for growing $N$ 50/50 $BS$ for all $N$}
\label{Azuma2}
\end{figure}
 
 Fig. \ref{Azuma2} shows the probabilities when we increase the number of interferometers but do not change the value of the $BS$ as $N$ increases, this may seem like a waste of effort since the aim is to maximize the detection probability. However let us assume that we have an absorber that has a very little absorption probability, if we wanted to have it absorbing our photon this scheme would prove useful

\section{Optical chopper as imperfect absorber in $N$ interferometers}
For an optical chopper the following matrix could be used:

\begin{equation}
A_{chopper}=\begin{pmatrix} f & 0 \\ 0 & 1 \end{pmatrix}.
\end{equation}

However as f only varies discretely our matrix will alternate between two values of $n$,between two transparencies :

\begin{equation}
f=\left(\frac{1-sgn(\sin(wt))}{2} \right)\beta+\frac{1+sgn(\sin(wt))}{2}.
\end{equation}

In the positive cycle we have $f_{positive}=1$. While on the negative cycle $f_{negative}=\beta$. For convenience, we will redefine $n=\abs{\beta}^{2}$ and write in terms of $n$, this way in the positive cycle we will have the case of the nested interferometer with no object which is the same as  $\beta=1$, but in the negative cycle, we will have  Azuma's case. We now use Azuma's matrix to perform the same analysis and also realize the probabilities will alternate between the blue line $\beta=1$ and the line which is $\beta=Transmittance$ of our chopper:


 \begin{figure}[!htb]
\centering
\begin{subfigure}[b]{0.3\linewidth}
\includegraphics[width=\linewidth]{images/ChopperD1.png}
\caption{$P_{D_{1}}$}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.3\linewidth}
\includegraphics[width=\linewidth]{images/ChopperD2.png}
\caption{$P_{D_{2}}$}
\label{fig:westminster_aerea}
\end{subfigure}
\begin{subfigure}[b]{0.3\linewidth}
\includegraphics[width=\linewidth]{images/Chopper_abs.png}
\caption{$P_{D_{2}}$}
\label{fig:BS1}
\end{subfigure}
\caption{Behavior for Growing $N$ for a chopper as imperfect absorbers}
\label{fig:several_chpper}
\end{figure}
 

Fig. \ref{fig:several_chpper} shows the probabilities of a given absorber, the blue line represents the ``hole" part of the chopper, and the other lines represent the ``material" part, the system will alternate periodically between these probabilities.

\section{Does the phase matter?}

As we saw in the previous section if we put several Mach-Zehnders in a row we can increase the probability of detecting in $D_{1}$ arbitrarily close to unity, (If we put the semitransparent objects in the other arm the opposite is true). However, neither in the treatment by Azuma \cite{Azuma} nor in the previous section the phase the object induces was considered, only its transmission coefficient. Is it unimportant?

To answer that question we explore how introducing a phase would affect our previous calculations. To introduce one one simply modifies Eqs. \ref{absorber} or \ref{absorber1}. by multiplying by a phase (equivalent to considering a phase shifter in the same arm). the resulting matrix is:

\begin{equation}
 A=\begin{pmatrix} \beta e^{i \theta}& 0\\0&  1\end{pmatrix}.
 \end{equation}

By doing the same procedure this time using symbolic computation so $\theta$ stays arbitrary (We are using sympy for symbolic computation), then we plot $P_{D_{1}},P_{D_{2}},P_{abs}$ Vs. $\theta$ fixing $N$.

\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/Azuma_phases2.png}
\caption{$N=2$}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/Azuma_phases5.png}
\caption{$N=5$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/Azuma_phases10.png}
\caption{$N=10$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/Azuma_phases100.png}
\caption{$N=100$}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/Azuma_phases1000.png}
\caption{$N=1000$ }
\label{1000}
\end{subfigure}
\caption{Behaviour of probabilities as $N$ grows}
\label{con_fase}
\end{figure}

As we see from Fig. \ref{con_fase} the phase is important when $N$ is small but as $N$  grows the dependence on the phase $\theta$ becomes smaller until we see for example in Fig \ref{1000} when $N$ is big. It is almost constant with the variation of $\theta$.
\section{Towards Wheeler's Gedanken experiment}

One of the main reasons the Mach-Zehnder Interferometer is so popular is that it allows us to study fundamental facts about quantum theory such as Bohr's complementary principle, this is well explained in \cite{delayed}. It consists in wondering if a photon behaves like a particle or a wave in a Mach-Zehnder interferometer, the idea is better explained by illustrating the Gedanken.

\begin{figure}[H]
\centering
\includegraphics[width=\linewidth,height=6.5 cm]{images/wheeler1.png}
\caption{Mach-Zehnder interferometer with both $BS$ being 50:50, we always detect on $D_{1}$}
\label{wheeler1}
\end{figure}

Let us picture a Mach-Zehnder interferometer like the one shown in Fig. \ref{wheeler1}, let both $BS$ be 50:50, now let us also imagine that we send in a single photon, from the section on a single photon interferometer we get Eq. \ref{pp_wheler}, if the difference in the optical path is $\gamma_{1}-\gamma_{2}=0$ then we get certainty of where the detection will be made ($D_{1}$), however, we have no information  of which path the photon took

\begin{figure}[H]
\centering
\includegraphics[width=\linewidth,height=6.5 cm]{images/wheeler2.png}
\caption{Mach-Zehnder interferometer without the second $BS$}
\label{wheeler2}
\end{figure}

Now let us consider this new arrangement as it is shown in Fig. \ref{wheeler2} where we removed the second beam splitter from the interferometer, this time we have no certainty of where the photon detection is going to be made ( It is split with equal probability to $D_{1}$ and $D_{2}$ ), however, once we detect we have complete information of which path the photon took.



So in one setting we have particle behavior and in the other, we have particle behavior, it seems somehow that before entering the experiment the photon somehow decides whether it is going to behave as a particle or wave, which seems to be in accordance with Bohr's complementary principle. This is precisely what Quantum delayed-choice experiments seek to rule out \cite{Ma}, where we choose to have particle or wave behavior or even a continuous transition between these two very different behaviors while the experiment is running.

\begin{figure}[H]
\centering
\includegraphics[width=\linewidth,height=7.5 cm]{images/wheeler3.png}
\caption{Mach-Zehnder interferometer with the second $BS$ is a in a superposition of being there and not being there}
\label{wheeler3}
\end{figure}

It was recently demonstrated by \cite{Peruzzo, Kaiser2012} that there is a smooth transition between particle and wave behaviors thus Bohr's complementary principle seems to be invalid. The way they did this experiment was through a very clever implementation of the original Gedanken experiment where we have a ``Quantum'' $BS$, which is a $BS$ that is in a superposition state of being there and not being there as the Fig. \ref{wheeler3}. The way they achieved this was by implementing a controlled Hadarmard gate \footnote{As was discussed in the beam splitter section a Hadamard gate is equivalent to a beam splitter}, that is it acts as an Identity gate if a control qubit is in the $0$ state and as a Hadamard gate is the controlled qubit is in the $1$ state. Thus if the control qubit was in a superposition state so it the Hadamard gate.




A similar situation arises through interaction-free measurements, since taking a path means interacting with the object, and taking the other path means no interaction, thus we have some sort of controlled gate. The first $BS$ puts us in a superposition of both paths (note that this approach differs significantly from the one taken in \cite{Peruzzo,Kaiser2012} because our $BS$ differ from a Hadamard gate by more than a phase this approach is more "controllable" ), and then both paths are recombined in the second $BS$ that is we always have the second beam splitter on as the experiments proposed recently do \cite{Polino}

\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd1_2.png}
\caption{$P_{D_{1}}$}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd2_2.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pabs_2.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\caption{Continuos transition between wave and particle behaviour with 50:50 BSs}
\label{transzuri}
\end{figure}

But if you have both $BS$ in the setup how can the transition between particle and wave behavior be achieved? The answer is quite simple, the object introduces two new parameters that can be tuned to change the behavior of the photon from particle to wave since these properties change the probabilities at the output as was studied in previous sections. This was done by Zurika Blanco-Garcia and Oscar Rosas-Ortiz in \cite{azuri} for the 50:50 $BS$ case. those plots are in perfect agreement with the experiments. However, no experimental realization has been done in this setup. Fig. \ref{transzuri} shows the transition from particle to wave behavior in the 50:50 case. (To make it more comparable to experiments we included the effect of misalignment $\gamma_{1},\gamma_{2}$, in the output they end up in a sum with the phase of the object, we included this in a single parameter $\Delta$):

\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth]{images/pd1_2_pi3.png}
\caption{$P_{D_{1}}$}
\end{subfigure}
\begin{subfigure}[b]{0.40\linewidth}
\includegraphics[width=\linewidth]{images/pd2_2_pi3.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\caption{Continuous transition between wave and particle behavior with 75:25 BSs}
\label{pi/3}
\end{figure}


However we do not need to restrict ourselves to the 50:50 case, other cases even though present the same shape as Fig. \ref{pi/3} they do it from different values of the parameters allowing us to test this beyond the 50:50 beam splitters.

\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd1_3_pi4.png}
\caption{$P_{D_{1}}$}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd2_3_pi4.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pabs_3_pi4.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd1_5_pi4.png}
\caption{$P_{D_{1}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd2_5_pi4.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pabs_5_pi4.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\caption{Continuous transition between wave and particle behaviour with 50:50 BSs for $N=3$ and $N=5$}
\label{varias}
\end{figure}

Now, what happens if we do $N$ interferometers in a row? how does this transition change? The answer is that we get multiple transitions as Fig. \ref{varias} shows, there we can see the plots for $N=3$ and $N=5$, in theses plots we consider all objects in the interferometer to be equal, we also considered all Beam Splitters to be 50:50 and we dropped the general form of the mirrors, so computation times are lower (that is we used $gamma_{1}=gamma_{2}=\frac{\pi}{2}$), as we can see we have more than one transition between particle and wave behavior, however, we see that this happens only for $\beta \approx 1$ which may suggest that the transition only happens for almost transparent or transparent objects. However, this is because as we explored in the $N$ interferometer section when we use these setups the absorption probability tends to unity.

\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd1_3.png}
\caption{$P_{D_{1}}$}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd2_3.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pabs_3.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd1_5.png}
\caption{$P_{D_{1}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pd2_5.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.30\linewidth}
\includegraphics[width=\linewidth]{images/pabs_5.png}
\caption{$P_{D_{2}}$ }
\label{fig:BS1}
\end{subfigure}
\caption{Continuous transition between wave and particle behaviour with $\theta=\frac{pi}{2N}$ BSs for $N=3$ and $N=5$}
\label{varias2}
\end{figure}

We can circumvent this by using $BS$ with $theta=\frac{\pi}{2N}$, exploiting the quantum Zeno effect as explained in the previous section, we could then see more interesting transitions, and we get plots like the ones in Fig. \ref{varias2} all of the other assumptions are maintained.



A more general complementary principle is formulated with regard to this experiments \cite{Ma}, this one is an inequality and goes as:

\begin{equation}
 V^{2} + D^{2} \leq 1,
\end{equation}

where $V$ is the visibility, $D$ is the distinguishability and are defined as :

\begin{align}
 V= \frac{P_{max}-P_{min}}{P_{max}+P_{min}}\\
 D_{i}=|p(i,1)-p(i,2)|
\end{align}

where $P_{max}$ and $P_{min}$ refer to the maximal and minimal for recording a photon in a chosen detector when scanning through the phase of the interferometer. The distinguishability or which-path information is defined as $D=D_{1}+D_{2}$ and $p(i,j)$ the probability that the photon travelled the path $i=1,2$ and arrived at detector $j=1,2$


In conclusion in this section, we proposed a simpler way to get the transition from wave and particle behavior, as \cite{Kaiser2012,Peruzzo} uses sophisticated equipment to implement a controlled Hadamard gate, we propose a simpler scheme to achieve the same plots both theoretically and experimentally. Besides requiring this complicated implementations a lot of debate has been arising since some claim that their experiment that the experiments in \cite{Kaiser2012,Peruzzo}  can be explained with a 2-dimensional classical variable \cite{Rossi,Chaves}, recently a proposal and implementation for an experiment that could not be explained in this way was presented in \cite{Polino}.

We could have an equivalent to such experiments with interaction-free measurements, instead of having to phase shifters like in \cite{Polino}. we could have a polarizer and analyzer followed by a phase shifter in one of the arms of the interferometer. and we could rotate both of them in the same way they do in \cite{Polino} by implementing random number generators.



\pagebreak







\pagebreak
\chapter{Experimental Setup}
In this chapter, we will describe the necessary materials and steps to realize all of the previous content of this thesis experimentally. All of the work from this section on took place at the laboratory for quantum and electromagnetic phenomena at UPIITA. We will begin by generating a single photon source using SPDC, we will follow the approach taken in \cite{maestria_procopio}. We will then replicate the Elitzur-Vaidman ``bomb detector''. Finally, we will study variations of this ``bomb detector'' with semitransparent objects.

\section{Single photon source}

To produce a single-photon source we will use the SPDC process described in chapter 1, to do this experimentally we will follow the method described in \cite{maestria_procopio}. The experimental setup can be seen in Fig. \ref{single}.  We will use the following materials:

\begin{figure}[!htb]
\centering
\includegraphics[width=\linewidth]{images/SPDC_exp.png}
\caption{Experimental setup of single photon source}
\label{single}
\end{figure}



\begin{itemize}

\item Aluminum rails
\item Infrared filters 810nm $\pm$ 10nm
\item Violet laser 405nm
\item Pinholes
\item BBO-I crystal
\item Multimode optical fiber
\item APDs(Avalanche photo-diodes)
\item National instruments' data acquisition board
\item Newport posts
\item Optical Table

\end{itemize}

The first step to achieve a single photon source is to find the most likely light-cone using individual counts in each photo-detector as described in chapter 2 section 2.1 where we explained type-I SPDC, after that, we need to count coincidences to identify spatial correlations as described in chapter 1. We will set the detection window for coincidences based on the procedure of \cite{pearson} at 10ns, this coincidence window is used so we know the pair of photons are created in the nonlinear crystal thus eliminating noise from the environment in the detection counts. It is usually convenient for the propagation direction of the photon to be co-lineal with one of the lines of tapped holes

In BBO-I crystals both photons have the same energy, from Eq. \ref{conservation} we can see that this implies that both signal and idler photons' direction of propagation makes the same angle with respect to the direction of the laser beam as seen in Fig. \ref{single}.

Since we know the relationship between each of the propagation directions, and it is in our best interest to have the signal photon co-lineal to the tapped holes, we will make the necessary adjustments so this happens. This is usually done by first setting the laser pump to be co-linear to the tapped holes, and then rotating both the laser and the crystal in such a way that the laser propagates in the direction previously occupied by the idler photon while the signal photon propagates in the direction previously occupied by the laser. The new direction of the idler photon can be found using Eq. \ref{conservation}.

Once we achieve this, we place APDs in the direction of propagation of both signal and idler photons. Our single-photon source is ready to go and the next step we need to take is to set up and align the Mach-Zehnder interferometer.

\section{Single photon Mach-Zehnder interferometer}

As we previously described in chapter 1, the Mach-Zehnder interferometer is made of two beam splitters ($BS_{1}$ and $BS_{2}$) and two mirrors($M_{1}$ and $M_{2}$). As the Eliztur-Vaidman ``bomb detector'' uses $50:50$ beam splitters and that's a result we want to replicate we will set up our interferometer using those. In addition to the previous section we will need:

\begin{itemize}
\item Two 50:50 Beam splitters
\item Two mirrors
\item Red laser 700nm
\item Incandescent white light source
\item Piezoelectric Thorlabs AE0505D-16F
\end{itemize}

We aim to get the difference in optical paths to a minimum, that is we wish to achieve $|\gamma_{2}-\gamma_{1}|=0+2\pi n$, this alignment can be quite challenging in the laboratory. To achieve this we will consider the following approach for alignment as discussed in \cite{zuri}. To align the interferometer and reduce $|\gamma_{2}-\gamma_{1}|$ as much as possible, the strategy is to attach a piezoelectric device to one of the mirrors, align it by hand and then varying the voltage applied to the piezoelectric (changing this mirror's orientation) until a minimum is reached.

Both $D_{1}$ and $D_{2}$ are APDs placed in the same way as in Fig.1, in the output of  $BS_{2}$, the interference pattern requires special treatment of the counts since unlike the classical case where we inject coherent beams into the interferometer we are injecting single photons. This ``special treatment'' consists in only considering detector clicks when there's a simultaneous coincidence in $D_{idler}$, where $D_{idler}$ is an APD placed in the path of the idler photon as described in the SPDC section, we will use the same temporal window of ``simultaneously'' as described in the previous section that is 10ns. The experimental set up for this section is shown in Fig. \ref{newsingle}.


\begin{figure}[!htb]
\centering
\includegraphics[width=\linewidth]{images/machzehnder_single.png}
\caption{Experimental setup of a single photon Mach-Zehnder Interferometer}
\label{newsingle}
\end{figure}

\subsection{Alignment of the Interferometer}

In this section, we will describe in detail the procedure used to align the Mach-Zehnder interferometer this approach was used in \cite{zuri}, as mentioned before the idea is to get $|\gamma_{2}-\gamma_{1}|=2\pi n$. It is necessary to be meticulous regarding the optical devices' position and characteristics, for instance, it is necessary to consider that the $BS$ faces are not completely flat, this is a problem because a $BS$ can change the propagation direction of the transmitted beam even when placed at $\theta=45\degree$. We will use $BS_{1}=BS_{2}=50:50$

To align the interferometer we begin by placing a red laser(HeNe) in such a way that the beam goes through the same path as the signal photon did in Fig. \ref{single}. To do this two collimators are needed. One is placed as close as possible to the BBO-I crystal, and the other one is placed near the $D_{signal}$ from the SPDC array. All alignment of our Mach-Zehnder interferometer is done using this red laser. In Fig.19 (a-d) all the steps we are going to take to align the interferometer are shown.

\begin{figure}[]
\centering
\begin{subfigure}[b]{0.55\linewidth}
\includegraphics[width=8cm,height=4 cm]{images/first_step.png}
\caption{First step}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.55\linewidth}
\includegraphics[width=8cm,height=4 cm]{images/second_step.png}
\caption{Second step}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.55\linewidth}
\includegraphics[width=8cm,height=4 cm]{images/third_step.png}
\caption{Third step}
\label{fig:BS1}
\end{subfigure}
\begin{subfigure}[b]{0.55\linewidth}
\includegraphics[width=8cm,height=4 cm]{images/last_step.png}
\caption{Fourth and last step}
\label{fig:westminster_aerea}
\end{subfigure}
\caption{Steps to align the Mach-Zehnder interferometer}
\label{steps}
\end{figure}



The first step is to place $BS_{1}$ at $\theta=45\degree$ with respect to the incoming beam so it is placed in its optimal position and does not deviate the beam. Additionally, both the transmitted and reflected beam must be co-linear to the tapped holes in the optical table. Using two screens we will mark where both the transmitted and reflected photons go as shown in Fig. \ref{steps} (a-d).

The second step is to place one of the mirrors $M_{2}$ in the path of the transmitted beam, the idea is to place $M_{2}$ in such a way that the reflected beam is co-lineal with the tapped holes of the optical table, and then mark on the screen the place where the beam goes, as is shown in Fig. \ref{steps}(b).

The third step is to dismount $M_{2}$(Only the mirror it isn't necessary to take out the post) and to place $M_{1}$ and repeat the step to using $M_{1}$ instead of $M_{2}$. We will place one of the mirrors in a ¿post? with a micro-metric screw and piezoelectric device to obtain vertical mobility, We will choose $M_{1}$, after completing this step we place $M_{2}$ once again, the expected result so far is shown in Fig. \ref{steps}(c).

The fourth and last step is to place $BS_{2}$ as it is shown in Fig. \ref{steps}(d), the reflected and transmitted beam should reach the marks done in step three, since we are working with a coherent beam we will see the interference pattern achieved on the screen. Once we have achieved the desired interference pattern, this same setup should be tested with white light from an incandescent source, that is because the coherence-length of the red laser is very long, so it is relatively easy to get red interference, therefore, using red light and getting an interference pattern is not such a precise test of alignment. When using white light it is way harder to get interference patterns visible, it requires a much finer alignment. After we have tested with white light, we will place the APDs on the marks that correspond to the mirrors' reflected beams.


We should make the Mach-Zehnder interferometer as small as possible, this allows better control over the length of the optical paths making alignment easier.

\subsection{Single-photon interference}

Once we've done all of this we are ready to start the experiments that mainly concern this thesis, we will begin by replicating the ``Elitzur-Vaidman'' experiment, and then move on to the variations with semitransparent objects.


\begin{itemize}
\item {\large \textbf{Perfect absorber}}
\end{itemize}
To have an imperfect absorber we will use a polarizer and an analyzer since we are using type-I SPDC (we are using a BBO-I crystal) we know that both the signal and idler photon will have identical polarizations and that it will be orthogonal to that of the photon. We can fabricate a perfect absorber by rotating the analyzer. This is because as Malus' law states \cite{hecht}

\begin{equation}
I=I_{0} \cos^{2}(\theta)
\end{equation}

where $I_{0}$ is the intensity before the polarizer and analyzer, $I$ is the intensity after them, and $\theta$ is the angle between the polarizer and analyzer if we rotate them in such a way that $\theta=0$ then we have our perfect absorber that can be placed in one of the arms of our interferometer


The Quantum version of this law is very similar \cite{malus} a generalization for fermions was also obtained. Therefore this analogy is valid both in the classical and quantum regime.
 \begin{itemize}
\item {\large \textbf{Semitransparent Objects}}
\end{itemize}

The behavior of a $BS$ is analogous to that of an analyzer and polarizer(same transmission and reflection/absorption coefficients) as Leonhartd states in \cite{Leonhardt_2003} a pictorial diagram of the analogy is shown in Fig. \ref{BS and polarizer}, so to get a fair number of experimental points in the $BS$ as imperfect transmitter curves, we will use a polarizer and analyzer and vary $\theta$, the ``lost'' photon will be absorbed instead. The same idea will be used for the $N$ beam-splitter section. Curves will be made once we know with how many we can count in the laboratory, that way setting $N$.

\begin{figure}[H]
\centering
\includegraphics[width=\linewidth]{images/polarizeranalogy.png}
\caption{Polarizer and analyzer analogy}
\label{BS and polarizer}
\end{figure}

An interesting experiment that could be replicated and generalized if time allows is the realization of ``$N$ interferometers'' as Kwait et al. realized in \cite{exp}, whereby taking advantage of this analogy and exploiting the quantum Zeno effect \cite{zeno} designed a version of this experiment that requires just a few optical devices, a semitransparent object could be placed in this setup enabling us to compare with the curves in section 5.


In the case of the chopper, one with perfect absorption would be quite difficult to implement, therefore this curves may not be tested and remain pending work, in the case of the chopper as an imperfect absorber the idea is to 3D print an optical chopper that is hollow and can be filled with different powders and liquids, changing its optical properties, the downside of this approach is that every time we fill it with something different its optical properties must be characterized.



\subsection{Varying optical paths}

To be able to see the interference pattern, it is necessary to adjust the difference in optical paths $\delta \phi$. Visibility is a quantitative measure of the quality of the interference pattern, classically it is defined as \cite{hecht}:

\begin{equation}
V=\frac{I_{max}-I_{min}}{I_{max}+I_{min}},
\end{equation}

where $I_{max}$ is the maximum intensity and $I_{min}$ is the minimum intensity of the interference pattern. The ideal pattern has perfect visibility ($V$=1), which happens when $I_{min}=0$.

In quantum mechanics the intensity is proportional to the expected value of the photon number \cite {glauber}, so the visibility is then given by:

\begin{equation}
V=\frac{N_{max}-N_{min}}{N_{max}+N_{min}},
\end{equation}

In the lab $N_{max}$ and $N_{min}$ correspond to the maximum and minimum coincidences $D_{1}-D_{idler}$ as we vary the voltage on the piezoelectric device.

Visibility counts will vary as we change the difference in optical paths $\delta\phi$ by varying the voltage on the piezoelectric attached to the mirror, the idea is to see how visibility changes with voltage and keep the maximum value that we can achieve to keep going with the rest of the experiments.
  
\pagebreak






\pagebreak 
\chapter{Conclusions}
\pagebreak


\chapter{Appendices}
\pagebreak

%prints bibliography from the bibliography file.


\bibliographystyle{unsrt}
\bibliography{bibliography}
\vspace{1 cm}

\end{document}
